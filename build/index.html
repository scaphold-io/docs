<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Scaphold API Reference</title>

    <link href="/images/favicon.ico" rel="icon" type="image/ico" />

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>

    <meta name="description" content="A real-time GraphQL powered backend platform. Build apps faster with our hosted data and intergrations platform. GraphQL Subscriptions make all of your apps realtime out of the box. Define your data model and instantly get a powerful GraphQL API backed by our highly available infrastructure built on AWS. Build web, mobile, and IOT apps with AngularJS, React, Relay, Apollo Client, Push Notifications, Stripe Payments, Twitter, Facebook, and more. Get started today."/>
    <meta name="keywords" content="create your own app, graphql service, graphql, ReactJS, make apps faster, best backend, best baas, graphql subscriptions, realtime, mobile app development, app development, firebase, firebase alternative, reactjs, angularjs, apollo client, relayjs"/>

    <!-- Facebook Pixel Code: Under Jun's Account -->
    <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
    document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '502625266592537', {
    em: localStorage.getItem('currentUserEmail'),
    });
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=502625266592537&ev=PageView&noscript=1"
    /></noscript>
    <!-- DO NOT MODIFY -->
    <!-- End Facebook Pixel Code -->

  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <div id="brand-logo">
        <a href="https://scaphold.io"><img src="images/logo.png" /></a>
      </div>
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
              <a href="#" data-language-name="javascript">JavaScript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://scaphold.io/?signupModal=true' target='_blank'>Build an app now!</a></li>
            <li><a href='https://scaphold.io/apps' target='_blank'>My Apps</a></li>
            <li><a href='https://scaphold.io/blog/' target='_blank'>Blog</a></li>
            <li><a href='http://status.scaphold.io/' target='_blank'>Network Status</a></li>
            <li><a href='https://scaphold.io/pricing' target='_blank'>Pricing</a></li>
            <li><a href='https://scaphold.io/referral' target='_blank'>Refer a friend! Get $25</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="introduction">Introduction</h1>

<blockquote>
<p><strong>The code snippets in this sidebar are designed to work in your apps directly.</strong> The requests are performed using the following resources.</p>

<p>GraphQL API: <script>document.write(window.apiUrl)</script></p>

<p>Email address: <script>document.write(window.currentUserEmail)</script></p>
</blockquote>

<p>Welcome! Scaphold is a backend-as-a-service platform that bundles all the tools you need to quickly build production-grade applications.
In a matter of minutes, you can create your own <strong>customizable GraphQL API</strong> backed by our highly available cloud infrastructure hosted on AWS.</p>

<p>As soon as you <a href="https://scaphold.io?signupModal=true">create an app on Scaphold</a>, you&rsquo;ll instantly have a persistent data
store, data modeling tools, advanced access control management, and monitoring dashboards all at your fingertips. This will
get you most of the way to launching your app, but why stop there?</p>

<p>Scaphold also provides two powerful features that will <strong>accelerate your team&rsquo;s app development like never before</strong>:</p>

<ol>
<li><p><a href="#subscriptions">Real-time</a>: With GraphQL Subscriptions enabled right out of the box, you can build advanced applications like
chat apps or games without having to spend any time building infrastructure to support it. Your users will immediately feel an
improvement in their experience on your app with millisecond subscription latencies and by reducing the overall number of requests
your app sends whenever there&rsquo;s an update.</p></li>
<li><p><a href="#integrations">Integrations</a>: Our integrations allow you to extend the functionality of your core API with push notifications,
payments, email, social authentication, and much more. We built Scaphold to power real workloads and that means allowing you to use
the same tools you already love.</p></li>
</ol>

<p><strong>New to GraphQL?</strong> <a href="#learn-graphql">Learn about it here!</a></p>

<p><strong>Already an expert?</strong> <a href="https://scaphold.io?signupModal=true">Get started now!</a></p>

<p><strong>Have any questions?</strong> <a href="https://scapholdslackin.herokuapp.com">Join our Slack!</a></p>

<h2 id="setup">Setup</h2>

<blockquote>
<p>In Scaphold&rsquo;s documentation, we&rsquo;ll be using the most common base networking library for each language. There are no tricks up our sleeves, it just works!</p>
</blockquote>
<pre class="highlight javascript"><code><span class="nx">npm</span> <span class="nx">install</span> <span class="o">--</span><span class="nx">save</span> <span class="nx">request</span>
</code></pre>

<p>GraphQL is a truly versatile query language for your API. This means that you can use any client networking library to make requests against
your GraphQL API. Whether you&rsquo;re building a Web, iOS, Android, or IOT app, GraphQL&rsquo;s got you covered.</p>

<p>In short,</p>

<ul>
<li>A <code class="prettyprint">query</code> is a <code class="prettyprint">string</code></li>
<li>The <code class="prettyprint">variables</code> are in <code class="prettyprint">json</code> format</li>
</ul>

<aside class="notice">
  Send the GraphQL query and variables together in one JSON payload in the content body of your request to your GraphQL API.
</aside>

<h2 id="why-graphql">Why GraphQL?</h2>

<blockquote>
<p>Describe your data</p>
</blockquote>
<pre class="highlight plaintext"><code>type Mission {
  id: ID!
  codename: String
  astronauts: [User]
}
</code></pre>

<blockquote>
<p>Ask for what you want</p>
</blockquote>
<pre class="highlight plaintext"><code>{
  getMission(id: "abc123") {
    codename
  }
}
</code></pre>

<blockquote>
<p>Get predictable results</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"getMission"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"codename"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GraphQL Takes Over The World!"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<aside class="notice">
All responses from your API will be formatted as JSON.
</aside>
</blockquote>

<p><a href="http://graphql.org/">GraphQL</a> was developed by Facebook over the years to power and scale many of their mobile and web applications. A
great deal of care was taken to ensure that GraphQL works from any client platform which means you can use Scaphold to build an application
on virtually any platform. This means you can target your Scaphold API from iOS, Android, Web, and IOT applications using any framework
<strong>without ever having to download an SDK</strong>! GraphQL presents a better way to build applications. It&rsquo;s that simple. You focus on what makes
your app awesome and let us worry about the rest!</p>

<p>Plus GraphQL is a massive improvement on REST. Here is why!</p>

<ol>
<li>A declarative type system helps create clean, structured, and safe APIs.</li>
<li>Write your queries once and run them anywhere! The intuitive GraphQL language is not only more powerful but also 100% cross-platform. No SDKs necessary!</li>
<li>Introspection lets you build documentation into the API itself. Your API easier to learn and eliminates the need to maintain external docs.</li>
<li>A GraphQL API has one endpoint. No more tricky RESTful urls.</li>
<li>Client driven. GraphQL empowers those who understand their requirements best. You!</li>
<li>It integrates seamlessly with the hottest frontend frameworks like React and Angular 2.0 using Relay and Apollo Client</li>
<li>And many many more!</li>
</ol>

<h2 id="learn-graphql">Learn GraphQL</h2>

<h3 id="resources">Resources</h3>

<ul>
<li><p>Facebook&rsquo;s <a href="http://graphql.org">GraphQL.org</a></p></li>
<li><p>Kadira&rsquo;s <a href="https://learngraphql.com/">LearnGraphQL.com</a></p></li>
<li><p>Apollo&rsquo;s <a href="http://www.graphql.com/">GraphQL.com</a></p></li>
<li><p><a href="https://scaphold.io/blog/2016/06/14/fastest-way-to-get-started.html">The Fastest Way to Get Started</a></p></li>
<li><p><a href="https://medium.com/chute-engineering/graphql-in-the-age-of-rest-apis-b10f2bf09bba#.el99enbvh">GraphQL vs. REST</a></p></li>
<li><p><a href="https://scaphold.io/blog/2016/10/31/state-of-graphql.html">State of GraphQL</a></p></li>
<li><p>Clay Allsopp&rsquo;s <a href="https://www.graphqlhub.com/">GraphQLHub.com</a></p></li>
<li><p><a href="https://graphql-slack.herokuapp.com/">Official GraphQL Slack</a></p></li>
<li><p><a href="https://scapholdslackin.herokuapp.com">Scaphold Slack</a></p></li>
<li><p><a href="http://graphql.org/community/">Other Community Sites</a></p></li>
<li><p><a href="https://github.com/chentsulin/awesome-graphql">Unofficial List of Resources</a></p></li>
</ul>

<p>If you have other additions to this list that you&rsquo;d like to add, feel free to contact us at our <a href="https://scapholdslackin.herokuapp.com">Slack channel</a>. Message either @vince or @michael.</p>

<h3 id="look-out-for">Look Out For&hellip;</h3>

<ul>
<li>More public GraphQL APIs</li>
<li>Relay 2.0!</li>
<li>GraphQL Subscriptions updates</li>
<li>Open source tooling released by companies that are using it internally</li>
<li>More mobile support</li>
</ul>

          <h1 id="core-data">Core Data</h1>

<p>Scaphold&rsquo;s core data platform allows you to easily define complex data models that are instantly deployed
to a production GraphQL API backed by a highly available SQL cluster. Core Data provides a great set of
tools for powering core application logic.</p>

<p>Every type in your schema that implements the <code class="prettyprint">Node</code> interface is backed by core data. That means every
type that implements <code class="prettyprint">Node</code> maps to a single table and can be related to any other core data types via
<code class="prettyprint">Connection</code> fields. Each core data type <code class="prettyprint">X</code> also receives a <code class="prettyprint">createX</code>, <code class="prettyprint">updateX</code>, and <code class="prettyprint">deleteX</code> mutation as well
as various ways to read the data with <code class="prettyprint">getX</code>, <code class="prettyprint">allX</code>, and through connections.</p>

<p>Scaphold allows you to write GraphQL queries that are compiled down to SQL which means you get powerful
filtering abilities with <code class="prettyprint">WhereArgs</code> as well as compound <code class="prettyprint">orderBy</code> expressions. We even expose the ability
for you to index certain fields in your data so that you can optimize the queries that are important to your
application.</p>

<h2 id="the-schema">The Schema</h2>

<blockquote>
<p>Example schema</p>
</blockquote>
<pre class="highlight plaintext"><code>type ScapholdSchema {
  id: ID!
  name: String!
  description: String
  types: [ScapholdType]
}

type ScapholdType {
  id: ID!
  name: String!
  description: String
  kind: "OBJECT" | "ENUM" | "INTERFACE"
  values: [String]                        # if ENUM
  fields: [ScapholdField]                 # if INTERFACE or OBJECT
  interfaces: [String]                    # if OBJECT
  permissions: [ScapholdPermission]
}

type ScapholdField {
  name: String!
  description: String
  type: String!
  ofType: String
  nonNull: Boolean
  unique: Boolean
  reverseName: String
}

interface Node {
  id: ID!
}
</code></pre>

<p>Every application you build on Scaphold will have a schema. A schema consists of a set of types and a set of
connections between those types. This connected web of types creates the &lsquo;graph&rsquo; that will come to define your API.</p>

<p>One of GraphQL&rsquo;s biggest benefits is that it provides a mechanism to express types at the API level. Types have
existed in general purpose programming languages and other query languages like SQL for years so it&rsquo;s about
time we brought it to APIs.</p>

<p>There are <strong>two main classes of types</strong> that you need to be aware of on Scaphold.</p>

<ol>
<li><p>Types that implement the <code class="prettyprint">Node</code> interface.
These are first-class entities in your Scaphold API. We will generate queries and mutations for them, you may create
connections between them, and you may use them with event-based integrations.</p></li>
<li><p>Types that <em>don&rsquo;t</em> implement the <code class="prettyprint">Node</code> interface.
These are auxiliary structures in your GraphQL API and these objects are stored inline within other <code class="prettyprint">Node</code> types.
Scaphold will not create queries and mutations for non-node types nor can you use them to fire event-based integrations.
You can, however, still relate them to other objects via the <code class="prettyprint">List</code> type or as an inline object.</p></li>
</ol>

<p>Scaphold&rsquo;s <a href="https://scaphold.io/apps">Schema Designer</a> allows you to define complex schemas in a fraction of the
time while also offering you a convenient place to setup access control rules (<a href="#permissions">permissions</a>) for your
data. As you define the structure of your schema we&rsquo;ll generate the backend that will host your custom GraphQL API. By
default we generate a <code class="prettyprint">get</code>, <code class="prettyprint">create</code>, <code class="prettyprint">update</code>, and <code class="prettyprint">delete</code> operation for each type in your schema. And to give you that
extra boost, we also create mutations to handle user authentication, schema migration, and integration management.</p>

<h3 id="scalars">Scalars</h3>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>The ID scalar type represents a unique identifier, often used to refetch an object or as the key for a cache. The ID type is serialized in the same way as a String; however, defining it as an <code class="prettyprint">ID</code> signifies that it is not intended to be human‐readable.</td>
</tr>
<tr>
<td>String</td>
<td>A UTF‐8 character sequence</td>
</tr>
<tr>
<td>Text</td>
<td>Character sequence with unlimited length (cannot be indexed or have a default value)</td>
</tr>
<tr>
<td>Int</td>
<td>A signed 32-bit integer</td>
</tr>
<tr>
<td>Float</td>
<td>A signed double-precision floating-point value</td>
</tr>
<tr>
<td>Boolean</td>
<td><code class="prettyprint">true</code> or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>DateTime</td>
<td>Valid timestamp that can be converted to standard ISO 8601 date time format.</td>
</tr>
</tbody></table>

<h3 id="types">Types</h3>

<blockquote>
<aside class="notice">
  Scaphold provides 3 objects types to start off with: <a href="#token-auth">User</a>, <a href="#roles">Role</a>, and <a href="#files">File</a>.
</aside>
</blockquote>
<pre class="highlight plaintext"><code>type Computer {
  id: ID!
  name: String!
  brand: String
  memory: Float
  diskSpace: Float
  numCores: Int
  price: Float
  isNew: Boolean
}
</code></pre>

<blockquote>
<aside class="notice">
  Scaphold provides 3 interfaces to start off with: <a href="#the-schema">Node</a>, <a href="#the-schema">Timestamped</a>, and <a href="#files">Blob</a>.
</aside>
</blockquote>
<pre class="highlight plaintext"><code>interface Animal {
  name: String
  height: Float
  weight: Float
}
</code></pre>

<blockquote>
<aside class="notice">
  Scaphold provides 2 enums to start off with: <a href="#authentication">CredentialType</a> and <a href="#permissions-authorization">AccessLevel</a>.
</aside>
</blockquote>
<pre class="highlight plaintext"><code>enum HouseTypeEnum {
  condominium
  apartment
  house
  duplex
}
</code></pre>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Object</td>
<td>These are the bread and butter of the GraphQL type system and schema. They are the model definitions of your data, telling the GraphQL server what types exist, the fields that belong to a type, and the complex relations between your data. GraphQL queries are validated against this type system. Scaphold allows you to easily define your types without having to write any server-side code, so you can leverage the benefits of GraphQL from your client side, without having to write this all yourself.</td>
</tr>
<tr>
<td>Interface</td>
<td>An interface is an abstract type that must be implemented by a type. The fields belonging to an interface must also exist on the type that implements it.</td>
</tr>
<tr>
<td>Enum</td>
<td>Enumerations are special scalar types that restrict values to a finite set of data.</td>
</tr>
</tbody></table>

<p><strong>Adding a Type</strong></p>

<p>In the Schema Designer tab once you&rsquo;ve created your app, click the dropdown on the top right to add a type.</p>

<p><img src="images/coredata/Add_Type.png" alt="add-type" /></p>

<h3 id="type-modifiers">Type Modifiers</h3>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>List</td>
<td>A List indicates that this field will return an array of a particular type. This is denoted in GraphQL as <code class="prettyprint">[ ... ]</code> surrounding the name of a type or scalar.</td>
</tr>
<tr>
<td>Non-Null</td>
<td>The Non-Null type modifier can also be used when defining arguments for a field, which will cause the GraphQL server to return a validation error if a null value is passed as that argument, whether in the GraphQL string or in the variables. This is denoted in GraphQL as a <code class="prettyprint">!</code> following the name of a type or scalar.</td>
</tr>
</tbody></table>

<h3 id="fields">Fields</h3>

<p>In GraphQL, like many other type systems, each type will have a set of fields associated with it. Fields are used to describe a particular type, and types in Scaphold will come by default
with an <code class="prettyprint">id</code>, <code class="prettyprint">createdAt</code>, and <code class="prettyprint">modifiedAt</code> fields as part of implementing the <code class="prettyprint">Node</code> and <code class="prettyprint">Timestamped</code> interfaces. These can be removed when creating a new type; however, a type must have at least one field.</p>

<p><strong>Adding a Field</strong></p>

<p>In the Schema Designer tab once you&rsquo;ve created your type, click the dropdown on the top right of a Type panel.</p>

<p><img src="images/coredata/Add_Field.png" alt="add-field" /></p>

<h2 id="queries">Queries</h2>

<blockquote>
<p>Example <code class="prettyprint">getX</code> query</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://us-west-2.api.scaphold.io/graphql/scaphold-graphql <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{"query": "query GetUser ($input: ID!) { getUser (id: $input) { id, username, createdAt, modifiedAt, lastLogin } }",
    "variables": {"input": "VXNlcjoxMQ=="}}'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="nx">request</span> <span class="nx">from</span> <span class="s1">'request'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"query"</span><span class="p">:</span> <span class="err">`</span><span class="nx">query</span> <span class="nx">GetUser</span> <span class="p">(</span><span class="na">$input</span><span class="p">:</span> <span class="nx">ID</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">getUser</span> <span class="p">(</span><span class="na">id</span><span class="p">:</span> <span class="nx">$input</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">id</span>
      <span class="nx">username</span>
      <span class="nx">createdAt</span>
      <span class="nx">modifiedAt</span>
      <span class="nx">lastLogin</span>
    <span class="p">}</span>
  <span class="p">}</span><span class="err">`</span><span class="p">,</span>
  <span class="s2">"variables"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"input"</span><span class="err">:</span> <span class="s2">"VXNlcjoxMQ=="</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">"https://us-west-2.api.scaphold.io/graphql/scaphold-graphql"</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"content-type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">},</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above command returns an object structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"getUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VXNlcjoxMQ=="</span><span class="p">,</span><span class="w">
      </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Elon Musk"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-08T12:33:56.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"modifiedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-08T12:33:56.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"lastLogin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-08T12:33:56.000Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<aside class="notice">
You can see every custom query available in the doc explorer in the GraphiQL tab.
See how GraphQL results directly mirror the query? It&rsquo;s awesome!
</aside>
</blockquote>

<p>Queries allow you to read data from your GraphQL API!</p>

<p>Each core data type <code class="prettyprint">X</code> gets its own queries <code class="prettyprint">getX</code> and <code class="prettyprint">viewer.allXs</code>. Since core data types can be involved in
connections, you can also read related objects through any connection fields in your schema. All core data connections
take the <code class="prettyprint">XWhereArgs</code> and <code class="prettyprint">XOrderByArgs</code> inputs that allow you to do complex filtering and compound ordering.</p>

<h3 id="viewer">Viewer</h3>

<blockquote>
<p>Example <code class="prettyprint">viewer</code> query</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://us-west-2.api.scaphold.io/graphql/scaphold-graphql <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{ "query": "query GetAllUsers($first: Int, $after: String, $orderBy: [UserOrderByArgs]) { viewer { allUsers(first: $first, after: $after, orderBy: $orderBy) { edges { cursor node { username createdAt } } } } }",
    "variables": { "first": 3, "after": "Yzp7ImNyZWF0ZWRBdCI6IjIwMTYtMTItMDhUMTU6MDI6MzguMDAwWiIsImlkIjo2fQ==", "orderBy": { "field": "createdAt", "direction": "DESC" } } }'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="nx">request</span> <span class="nx">from</span> <span class="s1">'request'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"query"</span><span class="p">:</span> <span class="err">`</span><span class="nx">query</span> <span class="nx">GetAllUsers</span><span class="p">(</span><span class="na">$first</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span> <span class="na">$after</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="na">$orderBy</span><span class="p">:</span> <span class="p">[</span><span class="nx">UserOrderByArgs</span><span class="p">])</span> <span class="p">{</span>
    <span class="nx">viewer</span> <span class="p">{</span>
        <span class="nx">allUsers</span><span class="p">(</span><span class="na">first</span><span class="p">:</span> <span class="nx">$first</span><span class="p">,</span> <span class="na">after</span><span class="p">:</span> <span class="nx">$after</span><span class="p">,</span> <span class="na">orderBy</span><span class="p">:</span> <span class="nx">$orderBy</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">edges</span> <span class="p">{</span>
            <span class="nx">cursor</span>
            <span class="nx">node</span> <span class="p">{</span>
              <span class="nx">username</span>
              <span class="nx">createdAt</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="err">`</span><span class="p">,</span>
  <span class="s2">"variables"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"first"</span><span class="err">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">"after"</span><span class="err">:</span> <span class="s2">"Yzp7ImNyZWF0ZWRBdCI6IjIwMTYtMTItMDhUMTU6MDI6MzguMDAwWiIsImlkIjo2fQ=="</span><span class="p">,</span>
    <span class="s2">"orderBy"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"field"</span><span class="err">:</span> <span class="s2">"createdAt"</span><span class="p">,</span>
        <span class="s2">"direction"</span><span class="err">:</span> <span class="s2">"DESC"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">"https://us-west-2.api.scaphold.io/graphql/scaphold-graphql"</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"content-type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">},</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above command returns an object structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"viewer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"allUsers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"edges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"cursor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Yzp7ImNyZWF0ZWRBdCI6IjIwMTYtMTItMDhUMTU6MDI6MjMuMDAwWiIsImlkIjo1fQ=="</span><span class="p">,</span><span class="w">
            </span><span class="nt">"node"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Steve Jobs"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-08T15:02:23.000Z"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"cursor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Yzp7ImNyZWF0ZWRBdCI6IjIwMTYtMTItMDhUMTU6MDI6MTcuMDAwWiIsImlkIjo0fQ=="</span><span class="p">,</span><span class="w">
            </span><span class="nt">"node"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bill Gates"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-08T15:02:17.000Z"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"cursor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Yzp7ImNyZWF0ZWRBdCI6IjIwMTYtMTItMDhUMTU6MDI6MDYuMDAwWiIsImlkIjozfQ=="</span><span class="p">,</span><span class="w">
            </span><span class="nt">"node"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Larry Page"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-08T15:02:06.000Z"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<aside class="notice">
The <code>RELATION</code> permission restricts access to queries through <code>viewer.user</code>.  This is how we are able
to efficiently enable you to provide full user field paths in your <code>RELATION</code> permission.
</aside>
</blockquote>

<p>The viewer is a convention from <a href="https://facebook.github.io/relay/"><code class="prettyprint">Relay</code></a> that allows you to both easily paginate
through all objects in your app as well as get a view for the currently logged in user. We generate a viewer field
<code class="prettyprint">allX</code> for each type <code class="prettyprint">X</code> in your schema. Queries that go through the viewer are subject to your set permissions so
users can only access the data you allow.</p>

<p>The viewer also contains a <code class="prettyprint">user</code> field that will always return information on the currently logged in user.</p>

<p>It&rsquo;s powerful since it uses connections and cursors to enable pagination out of the box! Cursors are essentially
a mechanism that uniquely identifies a single piece of data in a paginated list. With this unique ID, you can
apply it to the <code class="prettyprint">after</code> or <code class="prettyprint">before</code> parameters in your query to retrieve data past or prior to a particular piece
of data, respectively.</p>

<h2 id="mutations">Mutations</h2>

<p>A GraphQL mutation is a write followed by a fetch in one operation.</p>

<p>Mutations are your means of modifying data in your API. Each core data type <code class="prettyprint">X</code>, gets a <code class="prettyprint">createX</code>, <code class="prettyprint">updateX</code>, and <code class="prettyprint">deleteX</code>
mutation. Input arguments are automatically created to fit your schema and can be inspected from GraphiQL&rsquo;s Doc Explorer.</p>

<p>Here&rsquo;s an example of each type of mutation:</p>

<h3 id="create">Create</h3>
<pre class="highlight shell"><code>curl -X POST https://us-west-2.api.scaphold.io/graphql/scaphold-graphql <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{ "query": "mutation CreateUser($user: CreateUserInput!) { createUser(input: $user) { changedUser { id username } } }",
    "variables": { "user": { "username": "elon@tesla.com", "password": "SuperSecretPassword" } } }'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="nx">request</span> <span class="nx">from</span> <span class="s1">'request'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"query"</span><span class="p">:</span> <span class="err">`</span>
    <span class="nx">mutation</span> <span class="nx">CreateUser</span><span class="p">(</span><span class="na">$user</span><span class="p">:</span> <span class="nx">CreateUserInput</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">createUser</span><span class="p">(</span><span class="na">input</span><span class="p">:</span> <span class="nx">$user</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">changedUser</span> <span class="p">{</span>
          <span class="nx">id</span>
          <span class="nx">username</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="err">`</span><span class="p">,</span>
  <span class="s2">"variables"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"user"</span><span class="err">:</span> <span class="p">{</span>
      <span class="s2">"username"</span><span class="err">:</span> <span class="s2">"elon@tesla.com"</span><span class="p">,</span>
      <span class="s2">"password"</span><span class="err">:</span> <span class="s2">"SuperSecretPassword"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">"https://us-west-2.api.scaphold.io/graphql/scaphold-graphql"</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"content-type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">},</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above command returns an object structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"createUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"changedUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VXNlcjo3"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"elon@tesla.com"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<aside class="notice">
  The request above may throw an error since there&rsquo;s a <b>uniqueness constrainst set automatically</b> on the User model&rsquo;s <code>username</code> field.
</aside>
</blockquote>

<p>In this request, JSON-formatted variables are used to send an object as part of the payload for the mutation request.
The dollar sign ($) specifies a GraphQL variable, and the variable definition can be found in the variables section
of the request. Another thing to note here is that when introducing variables in the mutation string,
<code class="prettyprint">$user: CreateUserInput!</code> means that that variable is of type <code class="prettyprint">CreateUserInput!</code> and is required (!).</p>

<h3 id="update">Update</h3>
<pre class="highlight shell"><code>curl -X POST https://us-west-2.api.scaphold.io/graphql/scaphold-graphql <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{ "query": "mutation UpdateUser($user: UpdateUserInput!) { updateUser(input: $user) { changedUser { id username biography } } }",
    "variables": { "user": { "id": "VXNlcjox", "biography": "Spends his days saving the world with renewable energy." } } }'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="nx">request</span> <span class="nx">from</span> <span class="s1">'request'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"query"</span><span class="p">:</span> <span class="err">`</span>
    <span class="nx">mutation</span> <span class="nx">UpdateUser</span><span class="p">(</span><span class="na">$user</span><span class="p">:</span> <span class="nx">UpdateUserInput</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">updateUser</span><span class="p">(</span><span class="na">input</span><span class="p">:</span> <span class="nx">$user</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">changedUser</span> <span class="p">{</span>
          <span class="nx">id</span>
          <span class="nx">username</span>
          <span class="nx">biography</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="err">`</span><span class="p">,</span>
  <span class="s2">"variables"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"user"</span><span class="err">:</span> <span class="p">{</span>
      <span class="s2">"id"</span><span class="err">:</span> <span class="s2">"VXNlcjox"</span><span class="p">,</span>
      <span class="s2">"biography"</span><span class="err">:</span> <span class="s2">"Spends his days saving the world with renewable energy."</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">"https://us-west-2.api.scaphold.io/graphql/scaphold-graphql"</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"content-type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">},</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above command returns an object structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"updateUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"changedUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VXNlcjox"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Elon Musk"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"biography"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Spends his days saving the world with renewable energy."</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>You can also make a mutation to update data. The update operation performs a non-destructive update
to an object in your dataset. I.E. Update only updates the fields that you include as part of the
input. The object&rsquo;s <code class="prettyprint">id</code> is required in every update mutation so that we can uniquely identify the
object you would like to update. If you don&rsquo;t know it, you should perform a query operation to fetch
the data first, or save it in your application&rsquo;s state after creating the object.</p>

<h3 id="delete">Delete</h3>
<pre class="highlight shell"><code>curl -X POST https://us-west-2.api.scaphold.io/graphql/scaphold-graphql <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{ "query": "mutation DeleteUser($user: DeleteUserInput!) { deleteUser(input: $user) { changedUser { id username } } }",
    "variables": { "user": { "id": "VXNlcjo4" } } }'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="nx">request</span> <span class="nx">from</span> <span class="s1">'request'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"query"</span><span class="p">:</span> <span class="err">`</span>
    <span class="nx">mutation</span> <span class="nx">DeleteUser</span><span class="p">(</span><span class="na">$user</span><span class="p">:</span> <span class="nx">DeleteUserInput</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">deleteUser</span><span class="p">(</span><span class="na">input</span><span class="p">:</span> <span class="nx">$user</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">changedUser</span> <span class="p">{</span>
          <span class="nx">id</span>
          <span class="nx">username</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="err">`</span><span class="p">,</span>
  <span class="s2">"variables"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"user"</span><span class="err">:</span> <span class="p">{</span>
      <span class="s2">"id"</span><span class="err">:</span> <span class="s2">"VXNlcjo4"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">"https://us-west-2.api.scaphold.io/graphql/scaphold-graphql"</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"content-type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">},</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above command returns an object structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"deleteUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"changedUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VXNlcjo4"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"elon@spacex.com"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<aside class="notice">
  The request above may return `null`. This is an indication that you tried to delete a piece of data
  that doesn&rsquo;t exist.
</aside>
</blockquote>

<p>Use delete operations to delete data from your API. Delete requires the unique global identifier <code class="prettyprint">id</code>
of the piece of data that you wish to delete. Upon deleting data, you will receive the data back one
last time in case you need it again, and to serve as confirmation that that particular object was removed.</p>

<h2 id="subscriptions">Subscriptions</h2>

<blockquote>
<p>Example: Subscribe and get a real-time feed of when any user logs in or is created.</p>

<p>Query</p>
</blockquote>
<pre class="highlight plaintext"><code>subscription SubscribeToUser($user: [UserMutationEvent]!) {
  subscribeToUser(mutations: $user) {
    mutation
    value {
      id
      username
    }
  }
}
</code></pre>

<blockquote>
<p>Variables</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"loginUser"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"createUser"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>When Facebook open-sourced GraphQL, they described how applications can perform reads
with queries, and writes with mutations. However, oftentimes clients want to get pushed
updates from the server when data they care about changes. Enter Subscriptions. <strong>Subscriptions
make real-time functionality a first class citizen in GraphQL!</strong></p>

<p>Subscriptions offer a clean and efficient way to get pushed updates in real-time. They act
in parallel to mutations. Just like how mutations describe the set of actions you can
take to change your data, subscriptions define the set of events that you can subscribe
to when data changes. In fact, you can think of subscriptions as a way to react to
mutations made elsewhere.</p>

<p>For example, think about a chat application like <strong>Slack</strong>. To create a good user experience,
our application needs to stay up to date at all times. I.E. when a co-worker sends me a message,
I shouldn&rsquo;t have to refresh the page to see the message. A much better solution is to have the
server push my chat client the message as soon as it is created. This is how subscriptions work.
When someone creates a message (or in other words issues a mutation), the server immediately
pushes the data to every client that is both subscribed to that event.</p>

<aside class="notice">
    <b>GraphQL Subscriptions require a web socket connection.</b> This is client-specific. We use Apollo Client
    for our web apps as they have functionality to add a web socket handler to their base network interface.
</aside>

<h3 id="subscriptions-in-graphiql">Subscriptions in GraphiQL</h3>

<blockquote>
<p>Query</p>
</blockquote>
<pre class="highlight plaintext"><code>subscription SubscribeToNewMessages($messageFilter:MessageSubscriptionFilter) {
  subscribeToMessage(mutations:[createMessage], filter:$messageFilter) {
    mutation
    value {
      id
      content
      channel {
        id
        name
      }
      createdAt
    }
  }
}
</code></pre>

<blockquote>
<p>Variables</p>
</blockquote>
<pre class="highlight plaintext"><code>{
  messageFilter: {
    content: {
      matches: ".\*GraphQL.\*"
    },
    channelId: {
      eq: "SavedChannelId"
    }
  }
}
</code></pre>

<p>You can play around with Subscriptions in our GraphiQL page! It&rsquo;s hooked up to handle web socket connections, so Subscription
requests will work immediately. Normal HTTP clients won&rsquo;t work with Subscriptions since it requires a web socket connection.</p>

<p><img src="images/subscriptions/subs2.gif" alt="Subscriptions in GraphiQL" /></p>

<p>This is what I&rsquo;m doing:</p>

<p>1) I create a <code class="prettyprint">Channel</code> object with name <code class="prettyprint">GraphQL News!</code> and save its id.</p>

<p>2) By issuing the query to the right, I subscribe to all new messages that are created in the <code class="prettyprint">GraphQL News!</code> channel
and that have content matching the regex <code class="prettyprint">.*GraphQL.*</code></p>

<p>3) I send a <code class="prettyprint">Message</code> with content <code class="prettyprint">GraphQL is future!</code> to channel <code class="prettyprint">GraphQLNews!</code> and see a message pushed into the Subscription stream.</p>

<p>4) I send a <code class="prettyprint">Message</code> with content <code class="prettyprint">REST is dead!</code> to channel <code class="prettyprint">GraphQLNews!</code> and no message appears in the Subscription stream.</p>

<p>5) I send a <code class="prettyprint">Message</code> with content <code class="prettyprint">GraphQL Subscriptions are Awesome!</code> to channel <code class="prettyprint">GraphQLNews!</code> and another message appears in the Subscription stream.</p>

<p>6) I close the Subscription by double-tapping the pulse icon in the subscription stream.</p>

<p>Subscribing to changes to data in your API is that easy! There are a number of subscription filters you can use to
fine tune your subscriptions and you can even filter on One-To-Many and One-to-One connections using the associated
id filters.</p>

<p>Our Subscription implementation works (<em>almost</em>) out of the box with Apollo Client. Follow these
steps to make your app real-time!</p>

<h3 id="resources">Resources</h3>

<ul>
<li><a href="#subscriptions-with-apollo-client">Subscriptions with Apollo Client</a></li>
<li><a href="#subscriptions-with-react">Subscriptions with React</a></li>
<li><a href="the-full-slackr-tutorial">The full Slackr tutorial</a></li>
</ul>

<h2 id="connections-amp-pagination">Connections &amp; Pagination</h2>

<blockquote>
<p>Each type will have associated <code class="prettyprint">Connection</code> types like so:</p>
</blockquote>
<pre class="highlight plaintext"><code>type XConnection {
  edges: [XEdge]
  pageInfo: PageInfo
}

type XEdge {
  cursor: String
  node: X
}

type PageInfo {
  hasNextPage: Boolean!
  hasPreviousPage: Boolean!
}
</code></pre>

<blockquote>
<p>All connection fields will take the form:</p>
</blockquote>
<pre class="highlight plaintext"><code>query {
  connectionFieldOfTypeX (
    first: Int,
    after: String!,
    last: Int,
    before: String,
    orderBy: String
  ) {
    edges {
      cursor
      node {
        ...fields in type X
      }
    }
    pageInfo {
      hasNextPage
      hasPreviousPage
    }
  }
}
</code></pre>

<p>We use the concept of <code class="prettyprint">Connections</code> to provide a standardized way of paginating through large sets of objects.
You can use the <code class="prettyprint">Connection</code> type when defining your schema whenever you need to model relations on potentially
large sets of data.</p>

<p>Connections expose the following arguments:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>where</td>
<td><code class="prettyprint">Object</code></td>
<td>Object that represents SQL-like terms used for <a href="#filtering-whereargs">filtering</a> on a per-field basis</td>
</tr>
<tr>
<td>orderBy</td>
<td><code class="prettyprint">List</code></td>
<td>Fields that you wish to order by, and the order in which your app needs the data (<code class="prettyprint">ASC</code> or <code class="prettyprint">DESC</code>)</td>
</tr>
<tr>
<td>first</td>
<td><code class="prettyprint">Int</code></td>
<td>Acts as a limiting number of records to return and counts forward (i.e. from 0 to n)</td>
</tr>
<tr>
<td>after</td>
<td><code class="prettyprint">String</code></td>
<td>Pass in the cursor of an object, and you will retrieve the data <strong>after</strong> that particular record in a paginated list</td>
</tr>
<tr>
<td>last</td>
<td><code class="prettyprint">Int</code></td>
<td>Acts as a limiting number of records to return and counts backward (i.e. from n to 0)</td>
</tr>
<tr>
<td>before</td>
<td><code class="prettyprint">String</code></td>
<td>Pass in the cursor of an object, and you will retrieve the data <strong>before</strong> that particular record in a paginated list</td>
</tr>
</tbody></table>

<aside class="notice">
  Although connections expose <code>first</code>, <code>after</code>, <code>last</code>, and <code>before</code> we strongly recommend that you only ever use either
  (<code>first</code> and <code>after</code>) or (<code>last</code> and <code>before</code>) together at once as unexpected behavior can occur if you use both at the same time.
  The <code>orderBy</code> paramater allows you to order your data with respect to a field in the connected type and we will maintain the order throughout the pagination.
</aside>

<h3 id="one-to-one">One-to-One</h3>
<pre class="highlight shell"><code>curl -X POST https://us-west-2.api.scaphold.io/graphql/scaphold-graphql <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{ "query": "mutation UpdateCountry($input: UpdateCountryInput!) { updateCountry(input: $input) { changedCountry { id name capitalCity { id name } } } }",
    "variables": { "input": { "id": "Q291bnRyeTox", "capitalCityId": "Q2FwaXRhbENpdHk6MQ==" } } }'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"query"</span><span class="p">:</span> <span class="err">`</span>
    <span class="nx">mutation</span> <span class="nx">UpdateCountry</span><span class="p">(</span><span class="na">$input</span><span class="p">:</span> <span class="nx">UpdateCountryInput</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">updateCountry</span><span class="p">(</span><span class="na">input</span><span class="p">:</span> <span class="nx">$input</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">changedCountry</span> <span class="p">{</span>
          <span class="nx">id</span>
          <span class="nx">name</span>
          <span class="nx">capitalCity</span> <span class="p">{</span>
            <span class="nx">id</span>
            <span class="nx">name</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="err">`</span><span class="p">,</span>
  <span class="s2">"variables"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"input"</span><span class="err">:</span> <span class="p">{</span>
      <span class="s2">"id"</span><span class="err">:</span> <span class="s2">"Q291bnRyeTox"</span><span class="p">,</span>                         <span class="c1">// Country ID</span>
      <span class="s2">"capitalCityId"</span><span class="err">:</span> <span class="s2">"Q2FwaXRhbENpdHk6MQ=="</span>       <span class="c1">// Capital City ID</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">"https://us-west-2.api.scaphold.io/graphql/scaphold-graphql"</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"content-type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above command returns an object structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"updateCountry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"changedCountry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Q291bnRyeTox"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"United States"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"capitalCity"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Q2FwaXRhbENpdHk6MQ=="</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Washington, D.C."</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Given two types, <code class="prettyprint">Country</code> and <code class="prettyprint">CapitalCity</code>, you can designate a one-to-one relationship between them since one country can only have one capital city. In a one-to-one connection
between two types, there will be a field on each of the connected types that refers back to the other (i.e. reverse name). With that, you can associate an instance of <code class="prettyprint">Country</code>
with another instance of <code class="prettyprint">CapitalCity</code>.</p>

<p><strong>Steps:</strong></p>

<ol>
<li>Provided the two types have been created already, add a field called <code class="prettyprint">country</code> to <code class="prettyprint">CapitalCity</code> with this configuration.</li>
</ol>

<p><img src="images/coredata/One_To_One.png" alt="1-to-1 Connection" style="max-width: 50%" /></p>

<ol>
<li><p>Create an instance of <code class="prettyprint">Country</code>.</p></li>
<li><p>Create an instance of <code class="prettyprint">CapitalCity</code>.</p></li>
<li><p>Update the country instance with the id of the newly created capital city on the <code class="prettyprint">capitalCityId</code> field.</p></li>
</ol>

<h3 id="one-to-many">One-to-Many</h3>
<pre class="highlight shell"><code>curl -X POST https://us-west-2.api.scaphold.io/graphql/scaphold-graphql <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{ "query": "mutation UpdateFile($input: UpdateFileInput!) { updateFile(input: $input) { changedFile { id name owner { id username } } } }",
    "variables": { "input": { "id": "RmlsZTox", "ownerId": "VXNlcjox" } } }'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"query"</span><span class="p">:</span> <span class="err">`</span>
    <span class="nx">mutation</span> <span class="nx">UpdateFile</span><span class="p">(</span><span class="na">$input</span><span class="p">:</span> <span class="nx">UpdateFileInput</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">updateFile</span><span class="p">(</span><span class="na">input</span><span class="p">:</span> <span class="nx">$input</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">changedFile</span> <span class="p">{</span>
          <span class="nx">id</span>
          <span class="nx">name</span>
          <span class="nx">owner</span> <span class="p">{</span>
            <span class="nx">id</span>
            <span class="nx">username</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="err">`</span><span class="p">,</span>
  <span class="s2">"variables"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"input"</span><span class="err">:</span> <span class="p">{</span>
      <span class="s2">"id"</span><span class="err">:</span> <span class="s2">"RmlsZTox"</span><span class="p">,</span>                 <span class="c1">// File ID</span>
      <span class="s2">"capitalCityId"</span><span class="err">:</span> <span class="s2">"VXNlcjox"</span>       <span class="c1">// User ID</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">"https://us-west-2.api.scaphold.io/graphql/scaphold-graphql"</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"content-type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above command returns an object structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"updateFile"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"changedFile"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RmlsZTox"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"profilePicture"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VXNlcjox"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Elon Musk"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>One-to-many relationships work very similarly to one-to-one relationships. The difference is that after you connect two types, you <em>must</em> update the instance on the &ldquo;many side&rdquo; of the
connection. Only the &ldquo;many side&rdquo; instance will have a field that associates it to an instance of the &ldquo;one side&rdquo; of the relationship.</p>

<p>Given two types, <code class="prettyprint">User</code> and <code class="prettyprint">File</code>, you can designate a one-to-many relationship between them since one user can have multiple files, while a file can only have one owner (user). In a
one-to-many connection between two types, there will be a field injected on the file type called ownerId (id of the user). With that, you can associate an instance of <code class="prettyprint">User</code> with another instance of <code class="prettyprint">File</code>.</p>

<p><strong>Steps:</strong></p>

<ol>
<li>Provided the two types have been created already, add a field called <code class="prettyprint">files</code> to <code class="prettyprint">User</code> with this configuration.</li>
</ol>

<p><img src="images/coredata/One_To_Many.png" alt="1-to-Many Connection" style="max-width: 50%" /></p>

<ol>
<li><p>Create an instance of <code class="prettyprint">User</code>.</p></li>
<li><p>Create an instance of <code class="prettyprint">File</code>.</p></li>
<li><p>Update the file instance with the id of the newly created user on the <code class="prettyprint">ownerId</code> field.</p></li>
</ol>

<h3 id="many-to-many">Many-to-Many</h3>

<blockquote>
<p>For example, suppose we have the following schema:</p>
</blockquote>
<pre class="highlight plaintext"><code>type User {
  id: ID!
  username: String!
  posts: [Post]
  edits: [Post]
}

type Post {
  id: ID!
  title: String!
  content: String
  author: User
  editors: [User]
}
</code></pre>

<p>Many-to-many connections are defined by having two types with Connection fields pointing to one another via their <code class="prettyprint">reverseName</code> and have a special workflow for managing edges between their objects.</p>

<p>Given the example on the right, Scaphold will generate 3 special mutations for dealing with the many-to-many relations between <strong>User</strong> and <strong>Post</strong> via the edits &amp; editors fields. These mutations will be:</p>

<ol>
<li><code class="prettyprint">addToUserEditsConnection</code></li>
<li><code class="prettyprint">updateUserEditsConnection</code></li>
<li><code class="prettyprint">removeFromUserEditsConnection</code></li>
</ol>

<p>These mutations can be used to add edges between objects in the many-to-many connection.</p>

<aside class="notice">
  Connections are bi-directional and thus if you use addToUserEditsConnection(&hellip;) to add a post to a users set of edited posts, then it will also add that user to the posts set of editors.
</aside>

<p><strong>Special Case</strong></p>

<blockquote>
<p>Special Case Example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://us-west-2.api.scaphold.io/graphql/scaphold-graphql <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{ "query": "mutation AddFriendship($input: AddToFriendshipConnectionInput!) { addToFriendshipConnection(input: $input) { changedFriendship { status user1 { id username } user2 { id username } } } }",
    "variables": { "input": { "user1Id": "VXNlcjo0", "user2Id": "VXNlcjoz", "status": "Accepted" } } }'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"query"</span><span class="p">:</span> <span class="err">`</span>
    <span class="nx">mutation</span> <span class="nx">AddFriendship</span><span class="p">(</span><span class="na">$input</span><span class="p">:</span> <span class="nx">AddToFriendshipConnectionInput</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">addToFriendshipConnection</span><span class="p">(</span><span class="na">input</span><span class="p">:</span> <span class="nx">$input</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">changedFriendship</span> <span class="p">{</span>
          <span class="nx">status</span>
          <span class="nx">user1</span> <span class="p">{</span>
            <span class="nx">id</span>
            <span class="nx">username</span>
          <span class="p">}</span>
          <span class="nx">user2</span> <span class="p">{</span>
            <span class="nx">id</span>
            <span class="nx">username</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="err">`</span><span class="p">,</span>
  <span class="s2">"variables"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"input"</span><span class="err">:</span> <span class="p">{</span>
      <span class="s2">"user1Id"</span><span class="err">:</span> <span class="s2">"VXNlcjo0"</span><span class="p">,</span>
      <span class="s2">"user2Id"</span><span class="err">:</span> <span class="s2">"VXNlcjoz"</span><span class="p">,</span>
      <span class="s2">"status"</span><span class="err">:</span> <span class="s2">"Accepted"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">"https://us-west-2.api.scaphold.io/graphql/scaphold-graphql"</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"content-type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above command returns an object structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"addToFriendshipConnection"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"changedFriendship"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Accepted"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"user1"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VXNlcjo0"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Steve Jobs"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"user2"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VXNlcjoz"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bill Gates"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>If you wanted to create a many-to-many relationship between a type and itself, Scaphold makes it easy to do so! Perhaps you wanted to create a relation between a User type and itself, thereby defining a friendship.</p>

<p>The steps to do so are:</p>

<ol>
<li><p>Add a field to User called <code class="prettyprint">friends</code>.</p></li>
<li><p>It is a <code class="prettyprint">Connection</code> of type <code class="prettyprint">User</code> with a many-to-many relationship and a <strong>reverse name that is the same as the field name</strong>. Upon selecting the many-to-many relationship, a new field will appear called <code class="prettyprint">Connection Name</code>.
This will be the name of the &ldquo;join table&rdquo; (in the SQL sense) that will be automatically generated for you after creating the new connection.</p>

<p><img src="images/coredata/Many_To_Many.png" alt="Many-to-Many Connection" style="max-width: 50%" /></p></li>
<li><p>The resulting &ldquo;join table&rdquo; will be a new type in your schema. This creates a new table in Scaphold that will hold all your data that pertains to the
edges of the connection for friends on the User type and you can add additional fields to this type as well.</p></li>
</ol>

<p><img src="images/coredata/Join_Table.png" alt="Join Table" /></p>

<h2 id="filtering-whereargs">Filtering (WhereArgs)</h2>
<pre class="highlight shell"><code>curl -X POST https://us-west-2.api.scaphold.io/graphql/scaphold-graphql <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{ "query": "query ($where: UserWhereArgs) { viewer { allUsers(where: $where) { edges { node { id username } } } } }",
    "variables": { "where": { "username": { "like": "%elon%" } } } }'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"query"</span><span class="p">:</span> <span class="err">`</span>
    <span class="nx">query</span> <span class="p">(</span><span class="na">$where</span><span class="p">:</span> <span class="nx">UserWhereArgs</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">viewer</span> <span class="p">{</span>
        <span class="nx">allUsers</span><span class="p">(</span><span class="na">where</span><span class="p">:</span> <span class="nx">$where</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">edges</span> <span class="p">{</span>
            <span class="nx">node</span> <span class="p">{</span>
              <span class="nx">id</span>
              <span class="nx">username</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="err">`</span><span class="p">,</span>
  <span class="s2">"variables"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"where"</span><span class="err">:</span> <span class="p">{</span>
      <span class="s2">"username"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"like"</span><span class="err">:</span> <span class="s2">"%elon%"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">"https://us-west-2.api.scaphold.io/graphql/scaphold-graphql"</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"content-type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above command returns an object structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"viewer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"allUsers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"edges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"node"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VXNlcjo3"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"elon@tesla.com"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"node"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VXNlcjox"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Elon Musk"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Scaphold allows you to write GraphQL queries that are compiled down to SQL which means you get powerful filtering abilities with <code class="prettyprint">WhereArgs</code> as well as compound <code class="prettyprint">orderBy</code> expressions. We even expose the ability for you to
index certain fields in your data so that you can optimize the queries that are important to your application.</p>

<p>For each Node-implemented type, we provide a way to query using SQL-like syntax through GraphQL! For each field on a particular type, you are able to query by SQL operators and you will be returned a list of instances
that satisfy those filter arguments. The allowable operators include the following:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>eq</td>
<td>Equal to. This takes a higher precedence than the other operators.</td>
</tr>
<tr>
<td>gt</td>
<td>Greater than.</td>
</tr>
<tr>
<td>gte</td>
<td>Greater than or equal to.</td>
</tr>
<tr>
<td>lt</td>
<td>Less than.</td>
</tr>
<tr>
<td>lte</td>
<td>Less than or equal to.</td>
</tr>
<tr>
<td>ne</td>
<td>Not equal to.</td>
</tr>
<tr>
<td>between</td>
<td>A two element tuple describing a range of values.</td>
</tr>
<tr>
<td>notBetween</td>
<td>A two element tuple describing an excluded range of values.</td>
</tr>
<tr>
<td>in</td>
<td>A list of values to include.</td>
</tr>
<tr>
<td>notIn</td>
<td>A list of values to exclude.</td>
</tr>
<tr>
<td>like</td>
<td>A pattern to match for likeness.</td>
</tr>
<tr>
<td>notLike</td>
<td>A pattern to match for likeness and exclude.</td>
</tr>
<tr>
<td>isNull</td>
<td>Filters for null values. This takes precedence after <code class="prettyprint">eq</code> but before all other fields.</td>
</tr>
</tbody></table>

          <h1 id="authentication">Authentication</h1>

<p>Scaphold seemelessly handles user authentication for you. Each Scaphold application comes with a default User model which includes a <code class="prettyprint">username</code> and <code class="prettyprint">password</code> that are used to authenticate your users.
We securely encrypt and store each user&rsquo;s password as well as ensure that they are not readable.</p>

<h2 id="token">Token</h2>

<blockquote>
<p>Example <code class="prettyprint">loginUser</code> query</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://us-west-2.api.scaphold.io/graphql/scaphold-graphql <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{"query": "mutation LoginUserQuery ($input: LoginUserInput!) { loginUser(input: $input) { token user { id username createdAt } } }",
    "variables": { "input": { "username": "elon@tesla.com", "password": "SuperSecretPassword" } } }'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="nx">request</span> <span class="nx">from</span> <span class="s1">'request'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"query"</span><span class="p">:</span> <span class="err">`</span><span class="nx">mutation</span> <span class="nx">LoginUserQuery</span> <span class="p">(</span><span class="na">$input</span><span class="p">:</span> <span class="nx">LoginUserInput</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">loginUser</span><span class="p">(</span><span class="na">input</span><span class="p">:</span> <span class="nx">$input</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">token</span>
      <span class="nx">user</span> <span class="p">{</span>
        <span class="nx">id</span>
        <span class="nx">username</span>
        <span class="nx">createdAt</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span><span class="err">`</span><span class="p">,</span>
  <span class="s2">"variables"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"input"</span><span class="err">:</span> <span class="p">{</span>
      <span class="s2">"username"</span><span class="err">:</span> <span class="s2">"elon@tesla.com"</span><span class="p">,</span>
      <span class="s2">"password"</span><span class="err">:</span> <span class="s2">"SuperSecretPassword"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">"https://us-west-2.api.scaphold.io/graphql/scaphold-graphql"</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"content-type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">},</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above command returns an object structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"loginUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0ODI4ODI0ODgsImlhdCI6MTQ4MTU4NjQ4OCwiYXVkIjoiNDRiZTA4NmYtYmYzMy00OTk3LTgxMzYtOWMwMWQ5OWE4OGM0IiwiaXNzIjoiaHR0cHM6Ly9zY2FwaG9sZC5pbyIsInN1YiI6IjcifQ.TDRtD5vD7MIVrViDgVMThhzOzE_teufTo51a4GZ3aGA"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VXNlcjo3"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"elon@tesla.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-08T20:43:14.000Z"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p><b>Important</b>: Use the <code class="prettyprint">token</code> in the response in the header of future requests as:<br />
<code class="prettyprint">Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0ODI4ODI0ODgsImlhdCI6MTQ4MTU4NjQ4OCwiYXVkIjoiNDRiZTA4NmYtYmYzMy00OTk3LTgxMzYtOWMwMWQ5OWE4OGM0IiwiaXNzIjoiaHR0cHM6Ly9zY2FwaG9sZC5pbyIsInN1YiI6IjcifQ.TDRtD5vD7MIVrViDgVMThhzOzE_teufTo51a4GZ3aGA</code></p>
</blockquote>

<p>Logging in a user is simple. Use the <code class="prettyprint">loginUser</code> mutation we provide you and we will return a JSON Web Token (JWT) if the credentials match. To authenticate a user, you simply set the <code class="prettyprint">Authorization</code>
HTTP header of your request with the format <code class="prettyprint">Bearer {TOKEN_FROM_LOGIN_USER}</code>.</p>

<p>This token informs your API what user is logged in at any given time and enables our permissions system to layer access control rules on your data.</p>

<h2 id="permissions-authorization">Permissions (Authorization)</h2>

<blockquote>
<p><b>Important</b>: If a type has no permissions then anyone can perform any operations on it so make sure you add them before launching!</p>
</blockquote>

<p>Scaphold implements a permissions system that allows you to define powerful access control rules by leveraging a combination of features from role-based access control systems (RBAC) as well as the connections in your API&rsquo;s graph to define what users can access what information.</p>

<p>Each type and field in your schema has an optional set of permissions applied to it. When a user tries to complete an operation, your API checks the type- and field-level permissions and validates that the user is authorized to complete that operation. When you login to the Scaphold portal, you are logged in as an admin user and will have complete access to your application.</p>

<p>To add a permission, click on the <code class="prettyprint">+</code> sign in the top right for the panel of the type you wish to add a permission to. There you can add a permission for all of the fields of a particular type or only specific fields on that type.</p>

<p><img src="images/authentication/Add_Permissions.png" alt="Add Permissions" /></p>

<p>The following sections delineate the various types of permissioning that you can apply to your data.</p>

<aside class="notice">
  Keep in mind that if you layer permissions, the most lenient authorization rule wins.
</aside>

<h3 id="everyone">Everyone</h3>

<p><code class="prettyprint">Everyone</code> scoped permissions are the loosest available. Everyone can access the type. No login required.</p>

<h3 id="authenticated">Authenticated</h3>

<p><code class="prettyprint">Authenticated</code> scoped permissions required a valid auth token to be present in the request headers (See <a href="#token-auth">authentication</a> for more details). Scaphold provides a number of authentication mechanisms that all work seamlessly with your permissions.</p>

<h3 id="roles">Roles</h3>

<blockquote>
<p>GraphQL types used in role-based permissioning to manage roles, members, and access levels.</p>
</blockquote>
<pre class="highlight plaintext"><code>type User {
  id: ID!
  username: String
  password: Secret
  credentials: CredentialConnection
  lastLogin: DateTime
  roles: RoleConnection
  createdAt: DateTime
  modifiedAt: DateTime
}

type Role {
  id: ID
  name: String
  members: UserConnection
  createdAt: DateTime
  modifiedAt: DateTime
}

type UserRoles {
  accessLevel: AccessLevel
  createdAt: DateTime
  modifiedAt: DateTime
}

enum AccessLevel {
  admin
  readwrite
  readonly
}
</code></pre>

<p><code class="prettyprint">Role</code> permissions allow you to layer more generic role-based authentication methods on top of the connection and user-based permissions you already have. We have added a few queries and mutations that make it easy to manage your new roles and permissions.</p>

<p>In particular, you role-based permissioning is concerned with 3 object types: <code class="prettyprint">User</code>, <code class="prettyprint">Role</code>, and a through type called <code class="prettyprint">UserRoles</code>. In addition, we use the enum <code class="prettyprint">AcessLevel</code> to manage how much access we should provide a particular instance of a <code class="prettyprint">UserRole</code>.</p>

<table><thead>
<tr>
<th>Name</th>
<th>Inputs</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>getRole</td>
<td><code class="prettyprint">id: ID!</code></td>
<td>Get objects of type Role by id.</td>
</tr>
<tr>
<td>createRole</td>
<td><code class="prettyprint">name: String!</code></td>
<td>Creates a new role and enrolls the creator as a role admin.</td>
</tr>
<tr>
<td>updateRole</td>
<td><code class="prettyprint">id: ID!</code>, <code class="prettyprint">name: String</code></td>
<td>Update an existing role.</td>
</tr>
<tr>
<td>deleteRole</td>
<td><code class="prettyprint">id: ID!</code></td>
<td>Delete an existing role. Only role admins can delete roles.</td>
</tr>
<tr>
<td>addToUserRolesConnection</td>
<td><code class="prettyprint">userId: ID!</code>, <code class="prettyprint">roleID: ID!</code>, <code class="prettyprint">accessLevel: AccessLevel</code></td>
<td>Enrolls a user as a member of a role. Only admins can create other admins and you must be an admin to enroll another user.</td>
</tr>
<tr>
<td>updateUserRolesConnection</td>
<td><code class="prettyprint">userId: ID!</code>, <code class="prettyprint">roleID: ID!</code>, <code class="prettyprint">accessLevel: AccessLevel</code></td>
<td>Updates a connection between an object of type <code class="prettyprint">User</code> and an object of type <code class="prettyprint">Role</code>.</td>
</tr>
<tr>
<td>removeFromUserRolesConnection</td>
<td><code class="prettyprint">userId: ID!</code>, <code class="prettyprint">roleId: ID!</code></td>
<td>Removes a user from a role. Anyone can disenroll themself and admins can disenroll anyone.</td>
</tr>
</tbody></table>

<p>By default, we create a special <code class="prettyprint">admin</code> role for each of your apps. Users that are enrolled into the <code class="prettyprint">admin</code> role are given full access to your GraphQL API without having to specify any custom permissions.</p>

<blockquote>
<p><code class="prettyprint">Role</code> scoped permissions can be used alongside existing <code class="prettyprint">Relation</code> scoped permissions to easily create complex access control rules. Let&rsquo;s take an example where we would like to have a <b>set of notes</b> that <b>only executives of my company can see</b>.
Part of our schema might look something like this:</p>
</blockquote>
<pre class="highlight plaintext"><code>// Schema
type User {
  id: ID!
  username: String!
  authoredExecNotes: ExecutiveNoteConnection
}

type ExecutiveNote {
  id: ID!
  author: User
  content: String
}

// Permissions
[{
  scope: "ROLE",
  roles: ["Executives"],
  read: true,
  create: true
}
{
  scope: "RELATION",
  userFields: ["author"],
  update: true,
  delete: true
}]
</code></pre>

<h3 id="relation">Relation</h3>

<blockquote>
<p>Example of <code class="prettyprint">Relation</code> permission</p>

<p>A <code class="prettyprint">Post</code> model might have an <code class="prettyprint">author</code>. You could specify that only the author of the post can update it by adding the following permission to the <code class="prettyprint">Post</code> type:</p>
</blockquote>
<pre class="highlight plaintext"><code>{
  scope: "RELATION",
  userFields: ["author"],
  update: true
}
</code></pre>

<p><code class="prettyprint">Relation</code> scoped permissions use the connections in your data&rsquo;s graph to authorize behaviors. When you add a <code class="prettyprint">Relation</code> permission you tell Scaphold what <code class="prettyprint">User Fields</code> to inspect to check for the logged in user.</p>

<p>There is a special <code class="prettyprint">Relation</code> scope permission that gives a user sole access to their own user object. To enable this behavior create a <code class="prettyprint">Relation</code> scope permission with the desired operation and the user field <code class="prettyprint">me</code>.
A common use case for the <code class="prettyprint">me</code> user field is to give a user sole access to update their own user object.</p>

<h2 id="social">Social</h2>

<p>For social authentication, Scaphold has a solution for that as well! Integrating with OAuth providers like Facebook, Google, and Twtiter has never been easier with Scaphold&rsquo;s Auth0 integration.</p>

<p>Find out how to <a href="#social-auth">integrate social authentication</a> or <a href="#passwordless-auth">integrate passwordless authentication</a>.</p>

<h2 id="super-users">Super Users</h2>

<p>Scaphold provides the ability for you to generate an admin token that gives you super user access that supercedes all permission rules and access controls.
This is a great tool for importing or exporting data, any one-off data management tasks that need to be done, or scheduled jobs.</p>

<p>Please refer to the <a href="#admin-tokens">Admin Token section</a> under App Management for more details.</p>

          <h1 id="real-time">Real-Time</h1>

<h2 id="subscriptions-with-apollo-client">Subscriptions With Apollo Client</h2>

<blockquote>
<p>Condensed example from our Slackr app (JavaScript only)</p>
</blockquote>
<pre class="highlight javascript"><code><span class="cm">/* File: addGraphQLSubscriptions.js */</span>

<span class="kr">import</span> <span class="p">{</span> <span class="nx">print</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'graphql-tag/printer'</span><span class="p">;</span>

<span class="c1">// quick way to add the subscribe and unsubscribe functions to the network interface</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">addGraphQLSubscriptions</span><span class="p">(</span><span class="nx">networkInterface</span><span class="p">,</span> <span class="nx">wsClient</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">networkInterface</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">subscribe</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">wsClient</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">({</span>
        <span class="na">query</span><span class="p">:</span> <span class="nx">print</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">query</span><span class="p">),</span>
        <span class="na">variables</span><span class="p">:</span> <span class="nx">request</span><span class="p">.</span><span class="nx">variables</span><span class="p">,</span>
      <span class="p">},</span> <span class="nx">handler</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">unsubscribe</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">wsClient</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="p">},</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="cm">/* End of file: addGraphQLSubscriptions.js */</span>

<span class="o">------------------------------------------------------------------------</span>

<span class="cm">/* File: makeApolloClient.js */</span>

<span class="kr">import</span> <span class="nx">addGraphQLSubscriptions</span> <span class="nx">from</span> <span class="s1">'./addGraphQLSubscriptions'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">ApolloClient</span><span class="p">,</span> <span class="p">{</span> <span class="nx">createNetworkInterface</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'apollo-client'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">Client</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'subscriptions-transport-ws'</span><span class="p">;</span>

<span class="c1">// creates a subscription ready Apollo Client instance</span>
<span class="kr">export</span> <span class="kd">function</span> <span class="nx">makeApolloClient</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">scapholdUrl</span> <span class="o">=</span> <span class="s1">'us-west-2.api.scaphold.io/graphql/scaphold-graphql'</span><span class="p">;</span>
  <span class="kr">const</span> <span class="nx">graphqlUrl</span> <span class="o">=</span> <span class="err">`</span><span class="nx">https</span><span class="err">:</span><span class="c1">//${scapholdUrl}`;</span>
  <span class="kr">const</span> <span class="nx">websocketUrl</span> <span class="o">=</span> <span class="err">`</span><span class="nx">wss</span><span class="err">:</span><span class="c1">//${scapholdUrl}`;</span>
  <span class="kr">const</span> <span class="nx">networkInterface</span> <span class="o">=</span> <span class="nx">createNetworkInterface</span><span class="p">(</span><span class="nx">graphqlUrl</span><span class="p">);</span>
  <span class="nx">networkInterface</span><span class="p">.</span><span class="nx">use</span><span class="p">([{</span>
    <span class="nx">applyMiddleware</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Easy way to add authorization headers for every request</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">headers</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">req</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">headers</span> <span class="o">=</span> <span class="p">{};</span>  <span class="c1">// Create the header object if needed.</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">'scaphold_user_token'</span><span class="p">))</span> <span class="p">{</span>
        <span class="c1">// This is how to authorize users using http auth headers</span>
        <span class="nx">req</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">Authorization</span> <span class="o">=</span> <span class="err">`</span><span class="nx">Bearer</span> <span class="nx">$</span><span class="p">{</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">'scaphold_user_token'</span><span class="p">)}</span><span class="err">`</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">next</span><span class="p">();</span>
    <span class="p">},</span>
  <span class="p">}]);</span>
  <span class="kr">const</span> <span class="nx">wsClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">(</span><span class="nx">websocketUrl</span><span class="p">);</span>
  <span class="kr">const</span> <span class="nx">networkInterfaceWithSubscriptions</span> <span class="o">=</span> <span class="nx">addGraphQLSubscriptions</span><span class="p">(</span><span class="nx">networkInterface</span><span class="p">,</span> <span class="nx">wsClient</span><span class="p">);</span>

  <span class="kr">const</span> <span class="nx">clientGraphql</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ApolloClient</span><span class="p">({</span>
    <span class="na">networkInterface</span><span class="p">:</span> <span class="nx">networkInterfaceWithSubscriptions</span><span class="p">,</span>
    <span class="na">initialState</span><span class="p">:</span> <span class="p">{},</span>
  <span class="p">});</span>
  <span class="k">return</span> <span class="nx">clientGraphql</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* End of File: makeApolloClient.js */</span>
</code></pre>

<p>Apollo Client is a (currently) JavaScript-only networking interface that provides a fully-featured
caching GraphQL client for any server or UI framework. It&rsquo;s an easy-to-use GraphQL networking client
that works with HTTP and web socket requests. We use it at Scaphold to power our web apps, and many
of the examples in <a href="https://github.com/scaphold-io">our GitHub</a>. But you can also use it for your
React Native apps as well to address mobile needs. They are coming out with support for native mobile
iOS and Android clients as well. You can read more about it <a href="http://dev.apollodata.com/">here</a>.</p>

<p>The Scaphold GraphiQL page has already implemented the subscription protocol for you. The good news is that it is really easy to set this up in your own application. Here is how.</p>

<p>1) <strong>Download Apollo Client from npm!</strong> (Apollo Client works pretty much the same whether you are building a React, AngularJS, or vanilla JavaScript applications)</p>

<ul>
<li><p><code class="prettyprint">npm install apollo-client graphql-tag --save</code></p></li>
<li><p>If using React also <code class="prettyprint">npm install react-apollo --save</code></p></li>
<li><p>If using Angular2 also <code class="prettyprint">npm install angular2-apollo --save</code></p></li>
</ul>

<p>2) <strong>Configure the Apollo Client network layer to work with websockets.</strong> To do this we can use the following two code snippets:</p>

<p>The <code class="prettyprint">addGraphQLSubscriptions</code> function retrofits the Apollo Client network interface with the subscribe and unsubscribe methods that we can use from our application code.</p>

<p>The <code class="prettyprint">makeApolloClient</code> function then creates a new Apollo Client instance, applies the subscription methods, and adds a peice of authentication middleware before returning the client for use in our application.</p>

<p>This is all we need to do to configure our Apollo Client instance for GraphQL Subscriptions.</p>

<h2 id="subscriptions-with-react">Subscriptions With React</h2>

<blockquote>
<p>Condensed example from our Slackr app (JavaScript only)</p>
</blockquote>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">graphql</span><span class="p">,</span> <span class="nx">compose</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react-apollo'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">gql</span> <span class="nx">from</span> <span class="s1">'graphql-tag'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">ChannelMessagesQuery</span> <span class="o">=</span> <span class="nx">gql</span><span class="err">`</span>
<span class="nx">query</span> <span class="nx">GetPublicChannels</span><span class="p">(</span><span class="nx">$channelId</span><span class="err">:</span> <span class="nx">ID</span><span class="o">!</span><span class="p">,</span> <span class="nx">$messageOrder</span><span class="err">:</span> <span class="p">[</span><span class="nx">MessageOrderByArgs</span><span class="p">])</span> <span class="p">{</span>
  <span class="nx">getChannel</span><span class="p">(</span><span class="nx">id</span><span class="err">:</span> <span class="nx">$channelId</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">id</span>
    <span class="nx">name</span>
    <span class="nx">messages</span><span class="p">(</span><span class="nx">last</span><span class="err">:</span> <span class="mi">50</span><span class="p">,</span> <span class="nx">orderBy</span><span class="err">:</span> <span class="nx">$messageOrder</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">edges</span> <span class="p">{</span>
        <span class="nx">node</span> <span class="p">{</span>
          <span class="nx">id</span>
          <span class="nx">content</span>
          <span class="nx">createdAt</span>
          <span class="nx">author</span> <span class="p">{</span>
            <span class="nx">id</span>
            <span class="nx">username</span>
            <span class="nx">nickname</span>
            <span class="nx">picture</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="err">`</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">Messages</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>

    <span class="p">...</span>

    <span class="nx">componentWillReceiveProps</span><span class="p">(</span><span class="nx">newProps</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="o">!</span><span class="nx">newProps</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">loading</span> <span class="o">&amp;&amp;</span>
            <span class="nx">newProps</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">getChannel</span>
        <span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">getChannel</span> <span class="o">||</span>
                <span class="nx">newProps</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">.</span><span class="nx">id</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">.</span><span class="nx">id</span>
            <span class="p">)</span> <span class="p">{</span>
                <span class="c1">// If we change channels, subscribe to the new channel</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">subscribeToNewMessages</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="cm">/*
    *   Initiates the subscription and specifies how new data should be merged
    *   into the cache using the updateQuery method.
    */</span>
    <span class="nx">subscribeToNewMessages</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">subscription</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">subscribeToMore</span><span class="p">({</span>
            <span class="na">document</span><span class="p">:</span> <span class="nx">gql</span><span class="err">`</span>
                <span class="nx">subscription</span> <span class="nx">newMessages</span><span class="p">(</span><span class="na">$subscriptionFilter</span><span class="p">:</span><span class="nx">MessageSubscriptionFilter</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">subscribeToMessage</span><span class="p">(</span><span class="na">mutations</span><span class="p">:[</span><span class="nx">createMessage</span><span class="p">],</span> <span class="na">filter</span><span class="p">:</span> <span class="nx">$subscriptionFilter</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">value</span> <span class="p">{</span>
                            <span class="nx">id</span>
                            <span class="nx">content</span>
                            <span class="nx">createdAt</span>
                            <span class="nx">author</span> <span class="p">{</span>
                                <span class="nx">id</span>
                                <span class="nx">username</span>
                                <span class="nx">nickname</span>
                                <span class="nx">picture</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="err">`</span><span class="p">,</span>
            <span class="nx">variables</span><span class="err">:</span> <span class="p">{</span>
                <span class="nl">subscriptionFilter</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nl">channelId</span><span class="p">:</span> <span class="p">{</span>
                        <span class="c1">// We're using react-router and grabbing the channelId from the url</span>
                        <span class="c1">// to designate which channel to subscribe to</span>
                        <span class="nl">eq</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">params</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">channelId</span> <span class="p">:</span> <span class="kc">null</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>

            <span class="cm">/*
            *    Update query specifies how the new data should be merged
            *    with our previous results. Note how the structure of the
            *    object we return here directly matches the structure of
            *    the GetPublicChannels query.
            */</span>
            <span class="nx">updateQuery</span><span class="err">:</span> <span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="p">{</span> <span class="nx">subscriptionData</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="kr">const</span> <span class="nx">newEdges</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">...</span><span class="nx">prev</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">edges</span><span class="p">,</span>
                    <span class="p">{</span>
                        <span class="na">node</span><span class="p">:</span> <span class="p">{</span>
                            <span class="p">...</span><span class="nx">subscriptionData</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">subscribeToMessage</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">];</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="na">getChannel</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">messages</span><span class="p">:</span> <span class="p">{</span>
                            <span class="na">edges</span><span class="p">:</span> <span class="nx">newEdges</span><span class="p">,</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">};</span>
            <span class="p">},</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="p">...</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">MessagesWithData</span> <span class="o">=</span> <span class="nx">compose</span><span class="p">(</span>
  <span class="nx">graphql</span><span class="p">(</span><span class="nx">ChannelMessagesQuery</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">options</span><span class="p">:</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">channelId</span> <span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">params</span> <span class="p">?</span> <span class="nx">props</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">channelId</span> <span class="p">:</span> <span class="kc">null</span><span class="p">;</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="na">returnPartialData</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="na">variables</span><span class="p">:</span> <span class="p">{</span>
          <span class="nx">channelId</span><span class="p">,</span>
          <span class="na">messageOrder</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="na">field</span><span class="p">:</span> <span class="s1">'createdAt'</span><span class="p">,</span>
              <span class="na">direction</span><span class="p">:</span> <span class="s1">'ASC'</span>
            <span class="p">}</span>
          <span class="p">],</span>
        <span class="p">},</span>
      <span class="p">};</span>
    <span class="p">},</span>
  <span class="p">}),</span>
  <span class="p">...</span> <span class="c1">// We compose a few more queries in the actual app.</span>
<span class="p">)(</span><span class="nx">Messages</span><span class="p">);</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">MessagesWithData</span><span class="p">;</span>
</code></pre>

<p>Let&rsquo;s look at a more real world example using React. Apollo comes packed with really nice React bindings
that we can use to simplify the process of subscribing to data and merging new data into the client-side cache.</p>

<p>Take a minute to look over this file. Apollo does a great job allowing us to use real-time subscriptions alongside traditional queries and mutations. The combination of <code class="prettyprint">subscribeToMore</code> and <code class="prettyprint">updateQuery</code> offer a powerful set of tools to keep our UI up to date when dealing with real-time data!</p>

<p><a href="https://github.com/scaphold-io/slackr-graphql-subscriptions-starter-kit/blob/master/src/components/messages.jsx">See the complete code on GitHub</a></p>

<p>The <code class="prettyprint">returnPartialData: true</code> option is important. When you want to use <code class="prettyprint">subscribeToMore</code> to merge results into the result of a normal query it is necessary to specify this.</p>

<p>A few things are going on here. To make sense of what is happening, lets start from the logical beginning which actually occurs at the end of the file. See this line <code class="prettyprint">const MessagesWithData = compose(graphql(ChannelMessagesQuery, ...));</code>. This is the standard way to use Apollo to connect a react component with data from a GraphQL query. The <code class="prettyprint">graphql</code> function will wrap our component in a higher-order component that grabs our data and makes it available to our component via its <code class="prettyprint">props</code>. In this example, we will be able to access our <code class="prettyprint">Channel</code> data from our component with <code class="prettyprint">this.props.data.getChannel</code> as soon as it is fetched.</p>

<p>Okay so we have connected our component with a regular old GraphQL query, but how do we make it real-time? The key is the method <code class="prettyprint">subscribeToMore</code>.  Look at our <code class="prettyprint">subscribeToNewMessages</code> method. Apollo&rsquo;s <code class="prettyprint">graphql</code> function fits our component with the data prop that exposes the <code class="prettyprint">subscribeToMore</code> method. We use this method to attach a subscription query which then calls the <code class="prettyprint">updateQuery</code> method we pass in every time a new peice of data is pushed from the server. The object we return from <code class="prettyprint">updateQuery</code> is then merged with our previous results and persisted in the client side cache. This way, <code class="prettyprint">this.props.data.getChannel...</code> is always kept up to date and we can use it like normal to render our UI.</p>

<h2 id="the-full-slackr-tutorial">The Full Slackr Tutorial</h2>

<p>Follow along as we build a real-time chat application called Slackr. We will cover subscriptions in depth
and show you how to quickly make real-time apps with Apollo Client It covers a lot of material
and has a full example app to boot!</p>

<p><a href="https://scaphold.io/blog/2016/11/09/build-real-time-apps-with-subs.html">How to Build real-time Apps with GraphQL Subscriptions</a></p>

<p><strong>Slackr Starter Kit</strong></p>

<p>Check out the <a href="https://github.com/scaphold-io/slackr-graphql-subscriptions-starter-kit">Slackr Starter Kit on Github</a>.
Use it to jump start your next real-time application!</p>

          <h1 id="integrations">Integrations</h1>

<blockquote>
<aside class="notice">
  <b>Tip</b>: To understand how many of these integrations work in detail, and what new queries and mutations your API will have after enabling a particular integration, you can <b>click on an integration panel</b> in the Integrations Portal to find out.
</aside>
</blockquote>

<p>Use Scaphold&rsquo;s integration infrastructure to tie third-party services into your API. When you add an integration, we will automatically update your API with new functionality.
Integrations range in purpose. Want notifications? Add iOS Push. Want payments? Integrate Stripe. Need social auth? Add it with Auth0. Our collection of integrations is always expanding so please let us know if you have any specific requests.</p>

<p>Integrations come in many shapes and sizes. Some integrations like Slack and Webhooks are powered by events in your API while others like Mailgun will expose their functionality by adding queries and mutations to your GraphQL API.</p>

<p>We&rsquo;ve got some exciting new integrations coming out soon! Please <a href="mailto:support@scaphold.io">let us know</a> if you have any specific requests.</p>

<h2 id="email">Email</h2>

<p>Use <strong>Mailgun</strong> to send and manage email from within your application. Bind emails to events to automate your workflow.</p>

<ol>
<li>Create a free <a href="https://mailgun.com/">Mailgun</a> account.</li>
<li>Add the Mailgun integration and enter your API key and domain name in Scaphold&rsquo;s Integrations Portal.</li>
<li>Start sending emails and managing mailing lists from your Scaphold API!</li>
</ol>

<h2 id="monitoring">Monitoring</h2>

<p>Use <strong>Apollo Optics</strong> to add in-depth analytics for your API to understand how to optimize your queries.</p>

<ol>
<li>Create an <a href="http://www.apollostack.com/optics">Apollo Optics</a> account.</li>
<li>Add the Apollo Optics integration and enter your API key in Scaphold&rsquo;s Integration Portal.</li>
</ol>

<p>Every request you make will send information about how your data is being fetche, so you can view the performance of your all your requests through the comprehensive Optics dashboard.</p>

<h2 id="passwordless-auth">Passwordless Auth</h2>

<blockquote>
<p>We&rsquo;ve built a little playground for you to test out passwordless auth using Twitter Digits in an iOS app.
<a href="https://github.com/scaphold-io/ios-twitter-digits-playground">View on GitHub</a></p>

<p>Please reference this example if you&rsquo;re unfamiliar with how to obtain OAuth Echo Headers: <a href="https://fabric.io/kits/ios/digits/features">Sample Code</a></p>
</blockquote>

<p>Use <strong>Twitter Digits</strong> to extend your app&rsquo;s authentication capabilities, and log in your users with passwordless authentication using their phone number.</p>

<ol>
<li><p>Create a free Twitter Digits account online using <a href="https://docs.fabric.io/apple/digits/installation.html">Fabric</a>. This is the account management platform that Twitter uses to manage your Twitter integrations for your apps.</p></li>
<li><p>Once you&rsquo;ve done so and installed Digits to your app, follow the steps on the <a href="https://docs.fabric.io/apple/digits/sandbox.html#">Digits Sandbox</a> to configure your native app to test out the functionality in debug mode.</p></li>
<li><p>When you have this set up, you&rsquo;ll need to obtain <a href="https://docs.fabric.io/apple/digits/advanced-setup.html">OAuth Echo Headers</a>:</p>

<p><img src="images/integrations/Digits_Oauth_Echo_Headers.png" alt="Digits OAuth Echo Headers"></p></li>
<li><p>Now you can make a request with these header values with the <strong>new mutation called</strong> <code class="prettyprint">loginUserWithDigits</code> that will allow you to log in a user with this integration.</p>

<p>It will return a <strong>JWT token that you need to include in your future requests</strong> as the bearer token for your Authorization header so that we can authenticate this particular logged in user.</p>

<p>This works across authentication mechanisms on Scaphold, so you can link any number of social or passwordless authentication flows.</p>

<p><img src="images/integrations/Login_User_With_Digits.png" alt="loginUserWithDigits mutation." /></p></li>
</ol>

<h2 id="payments">Payments</h2>

<p>Hook into <strong>Stripe</strong> to instantly add advanced payment methods to your application.</p>

<p>The Stripe integration allows you to quickly and easily link your company&rsquo;s Stripe account with your Scaphold API.</p>

<ol>
<li>Head to <a href="https://stripe.com/">Stripe</a> and create a free account to get started.</li>
<li>Upload your secret key and publishable key via our <a href="https://scaphold.io/apps">Integrations Portal</a>.</li>
<li>Rejoice as we have just added tons of new payments functionality to your API.</li>
</ol>

<h2 id="push-notifications">Push Notifications</h2>

<p>Add <strong>iOS</strong> or <strong>Android</strong> push notifications in an instant.</p>

<ol>
<li>Follow <a href="https://www.raywenderlich.com/123862/push-notifications-tutorial">this tutorial</a> to create an SSL certificate and PEM file</li>
<li>Add the iOS integration and upload your SSL cert and PEM file through our <a href="https://scaphold.io/apps">Integrations Portal</a>.</li>
<li>Immediately get access to iOS or Android push notifications via your app&rsquo;s GraphQL API.</li>
</ol>

<p>Once you&rsquo;ve set up your keys, you can start managing device tokens across platforms and send push notification messages to valid device tokens and users.</p>

<h2 id="search">Search</h2>

<blockquote>
<p>We&rsquo;ve built a small boilerplate for you to get started quickly with <a href="https://github.com/scaphold-io/auth0-lock-playground" target="_blank">Auth0 Lock in React</a>.</p>
</blockquote>

<p>Use <b>Algolia</b> to extend your app&rsquo;s search capabilities, and query your data seamlessly as your data changes.</p>

<ol>
<li><p>Create a free <a href="https://www.algolia.com/">Algolia</a> account. This will help you manage your search indices and monitor your usage. Once you&rsquo;ve created your account, you&rsquo;ll receive an Application ID and an API Key.</p>

<p><aside class="notice">
      For different apps on Scaphold, you&rsquo;ll need to create a new Algolia account with different keys since new search indices will interfere with existing ones.
    </aside></p></li>
<li><p>Configure <strong>Algolia</strong> in Scaphold from the <a href="https://scaphold.io/apps">Integrations Portal</a> and select the checkboxes in the popup to index data of that particular type.</p>

<p><img class="news-how-to-img" src="images/integrations/Algolia_Index.png" alt="Configure your Algolia integration"></p></li>
<li><p>As soon as you enable search on a particular type, Scaphold will index each existing piece of data for that type into Algolia&rsquo;s system and future CREATE, UPDATE, and DELETE commands will be reflected in both Scaphold and Algolia for search. These commands will be the same as before; however you now have a <strong>new query for each indexed type under Viewer</strong> that will allow you to search for query terms along with optional parameters.</p>

<p><img class="news-how-to-img" src="images/integrations/Algolia_Viewer.png" alt="Search for a term"></p></li>
</ol>

<h2 id="social-auth">Social Auth</h2>

<p>Use <strong>Auth0</strong> to extend your app&rsquo;s login and registration flow painlessly through your favorite social authentication services.</p>

<ol>
<li><p>Create a free <a href="https://auth0.com/">Auth0</a> account. This will help you manage your app credentials like client IDs and secrets for your OAuth providers. By connecting your apps on your social accounts like Facebook, Google, and Twitter, you&rsquo;ll then have the correct account credentials to utilize these services for your authentication flow.</p>

<p><img src="images/integrations/Configure_Auth0_Account.png" alt="Configure your Auth0 apps."></p></li>
<li><p>Configure Auth0 in Scaphold from the <a href="https://scaphold.io/apps">Integrations Portal</a> to include the OAuth providers that you plan to use for your app. This will enable a new mutation called <code class="prettyprint">loginUserWithAuth0Social</code> which you can use to log in users with connected OAuth providers.</p></li>
<li><p>In your client app, you&rsquo;ll likely be using a client SDK to handle user login. For instance, you can use the <a href="https://github.com/facebook/react-native-fbsdk">Facebook SDK for React Native</a> to ask your users to log in with their existing Facebook accounts. Once this succeeds, you&rsquo;ll receive an <code class="prettyprint">access token</code> to send to Scaphold.</p>

<p><img src="images/integrations/Configure_Auth0.png" alt="Configure your Auth0 integration to include auth providers"></p>

<p><img src="images/integrations/Get_Access_Token.png" alt="Get access token"></p>

<p><aside class="notice">
      <strong>UPDATE:</strong> Mutation name is now called <code class="prettyprint">loginUserWithAuthOSocial</code>
    </aside></p></li>
<li><p>After Scaphold verifies the access token with the OAuth provider (i.e. Facebook), we&rsquo;ll pass back the <strong>JSON Web Token (JWT)</strong> that you&rsquo;ll need to add to your authorization header for future requests. That way, you will be authorized to make future requests through Scaphold and it will also provide us the capability to work on that user&rsquo;s behalf to access the OAuth provider&rsquo;s resources. For instance, we could authorize you to access your Facebook friends and their public profile information.</p>

<p><img src="images/integrations/Insert_Jwt_Header.png" alt="Set JWT token in header"></p></li>
<li><p>In addition, if you&rsquo;ve logged in already and you make a request to <code class="prettyprint">loginUserWithAuth0Social</code> again but with a new OAuth provider (i.e. Google), Scaphold will link your two accounts together, since we know the requests being made belong to one user. Now, you&rsquo;ll have access to both Facebook and Google information using Facebook&rsquo;s and Google&rsquo;s account credentials.</p>

<p><img src="images/integrations/Link_Google_User.png" alt="Link Google account"></p>

<p><aside class="notice">
      <strong>UPDATE:</strong> Mutation name is now called <code class="prettyprint">loginUserWithAuthOSocial</code>
    </aside></p></li>
<li><p>If you&rsquo;d like to use Auth0 Lock as a client-side SDK to manage your authentication, you can do so with the <code class="prettyprint">loginUserWithAuth0Lock</code> mutation. This accepts the identity parameter that the client receives from a successful Auth0 Lock login in the profile variable. These work in sync with all other Scaphold basic and social authentication flows so you can manage your users the way you want.</p></li>
</ol>

<h2 id="webhooks">Webhooks</h2>

<p>Use the <strong>Custom</strong> integration to define webhooks, events, and custom logic in your API. Perhaps you would like to send an email to your users to welcome them after they&rsquo;ve signed up. Webhooks are a powerful way to implement this workflow.</p>

<ol>
<li><p>Host a microservice with an HTTP URL (you can use something like <a href="https://aws.amazon.com/lambda/">AWS Lambda</a>) that defines the custom logic you need (perhaps to send a welcome email).</p></li>
<li><p>Configure the integration in Scaphold with the microservice URL that you want to send the request to, along with the fragment of the mutation that is associated with the data, in order to supply the microservice with the appropriate information.</p></li>
<li><p>Set when you want to the webhook to fire (e.g. <code class="prettyprint">afterCreate</code> on the <code class="prettyprint">User</code> type).</p></li>
</ol>

          <h1 id="files">Files</h1>

<blockquote>
<aside class="notice">
  All Scaphold APIs come with blob storage by default and all paid apps will be served files through a globally distributed CDN.
</aside>
</blockquote>

<p>File support in Scaphold is cooked into your schema. That means that any type that implements the <code class="prettyprint">Blob</code>
interface can be associated with a file stored in our distributed blob storage. When you create
an app, we start you off with both the <code class="prettyprint">Blob</code> interface as well as a <code class="prettyprint">File</code> type. The <code class="prettyprint">File</code> type implements
<code class="prettyprint">Blob</code> and <code class="prettyprint">Node</code> and thus can both be connected to other types in your schema via Connection fields as well
as handle file uploads and downloads.</p>

<h3 id="uploading-files">Uploading Files</h3>

<blockquote>
<p>Example file upload
Mark Zuckerberg&rsquo;s user ID: <code class="prettyprint">VXNlcjoxMA==</code></p>
</blockquote>
<pre class="highlight shell"><code>curl -v https://us-west-2.api.scaphold.io/graphql/scaphold-graphql <span class="se">\</span>
  -H <span class="s2">"Content-Type:multipart/form-data"</span> <span class="se">\</span>
  -F <span class="s1">'query=mutation CreateFile($input: CreateFileInput!) { createFile(input: $input) { changedFile { id name blobMimeType blobUrl user { id username } } } }'</span> <span class="se">\</span>
  -F <span class="s1">'variables={ "input": { "name": "Profile Picture", "userId": "VXNlcjoxMA==", "blobFieldName": "myBlobField" } };type=application/json'</span> <span class="se">\</span>
  -F <span class="nv">myBlobField</span><span class="o">=</span>@mark-zuckerberg.jpg
</code></pre>
<pre class="highlight javascript"><code>
<span class="c1">// You must also install these npm modules:</span>
<span class="c1">// npm install --save form-data</span>
<span class="c1">// npm install --save node-fetch</span>

<span class="kd">var</span> <span class="nx">fetch</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'node-fetch'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">FormData</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'form-data'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">form</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">();</span>
<span class="nx">form</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"query"</span><span class="p">,</span> <span class="err">`</span>
  <span class="nx">mutation</span> <span class="nx">CreateFile</span><span class="p">(</span><span class="nx">$input</span><span class="err">:</span> <span class="nx">CreateFileInput</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">createFile</span><span class="p">(</span><span class="nx">input</span><span class="err">:</span> <span class="nx">$input</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">changedFile</span> <span class="p">{</span>
        <span class="nx">id</span>
        <span class="nx">name</span>
        <span class="nx">blobMimeType</span>
        <span class="nx">blobUrl</span>
        <span class="nx">user</span> <span class="p">{</span>
          <span class="nx">id</span>
          <span class="nx">username</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="err">`</span><span class="p">);</span>
<span class="nx">form</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"variables"</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
  <span class="s2">"input"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Mark Zuck Profile Picture"</span><span class="p">,</span>
    <span class="s2">"userId"</span><span class="p">:</span> <span class="s2">"VXNlcjoxMA=="</span><span class="p">,</span>
    <span class="s2">"blobFieldName"</span><span class="p">:</span> <span class="s2">"myBlobField"</span>
  <span class="p">}</span>
<span class="p">}));</span>
<span class="c1">// The file's key matches the value of the field `blobFieldName` in the variables</span>
<span class="nx">form</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"myBlobField"</span><span class="p">,</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="s1">'./mark-zuckerberg.jpg'</span><span class="p">));</span>

<span class="nx">fetch</span><span class="p">(</span><span class="s2">"https://us-west-2.api.scaphold.io/graphql/scaphold-graphql"</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">form</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above command returns an object structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"createFile"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"changedFile"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RmlsZTo5"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mark Zuck's Profile Picture"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"blobMimeType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/jpeg"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"blobUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://s3-us-west-2.amazonaws.com/production.us-west-2.scaphold.v2.customer/44be086f-bf33-4997-8136-9c01d99a88c4/data/2fb4b11d-cef9-465d-9ad6-e3d8b693f121/2b86488a-7114-4071-9e30-157855475eb7?AWSAccessKeyId=AKIAJIC3JY2ICINJH2OQ&amp;Expires=1481686711&amp;Signature=pa4QbkPCk%2BXlgSrKBWcRKsEckSs%3D"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VXNlcjoxMA=="</span><span class="p">,</span><span class="w">
          </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mark Zuckerberg"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Uploading files is simple. All you need to do is attach the file to a multipart/form-data request
and point to it using the <code class="prettyprint">blobFieldName</code> attribute in the <code class="prettyprint">Blob</code> implemented type&rsquo;s input object.</p>

<p>All types that implement <code class="prettyprint">Blob</code> will receive an additional input field called <code class="prettyprint">blobFieldName</code>.</p>

<h3 id="querying-files">Querying Files</h3>

<blockquote>
<p>Example of querying for a file
File ID: <code class="prettyprint">RmlsZTo5</code></p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://us-west-2.api.scaphold.io/graphql/scaphold-graphql <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{ "query": "query GetFile { getFile(id: \"RmlsZTo5\") { id name blobMimeType blobUrl user { id username } } }",
    "variables": {} }'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"query"</span><span class="p">:</span> <span class="err">`</span>
    <span class="nx">query</span> <span class="nx">GetFile</span> <span class="p">{</span>
      <span class="nx">getFile</span><span class="p">(</span><span class="na">id</span><span class="p">:</span> <span class="s2">"RmlsZTo5"</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">id</span>
        <span class="nx">name</span>
        <span class="nx">blobMimeType</span>
        <span class="nx">blobUrl</span>
        <span class="nx">user</span> <span class="p">{</span>
          <span class="nx">id</span>
          <span class="nx">username</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="err">`</span><span class="p">,</span>
  <span class="s2">"variables"</span><span class="err">:</span> <span class="p">{}</span>
<span class="p">}</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">"https://us-west-2.api.scaphold.io/graphql/scaphold-graphql"</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"content-type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above command returns an object structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"getFile"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RmlsZTo5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mark Zuck's Profile Picture"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"blobMimeType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/jpeg"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"blobUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://s3-us-west-2.amazonaws.com/production.us-west-2.scaphold.v2.customer/44be086f-bf33-4997-8136-9c01d99a88c4/data/2fb4b11d-cef9-465d-9ad6-e3d8b693f121/2b86488a-7114-4071-9e30-157855475eb7?AWSAccessKeyId=AKIAJIC3JY2ICINJH2OQ&amp;Expires=1481690209&amp;Signature=icwTcNl%2B%2BTwQy8Ar6jLuquztwu0%3D"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VXNlcjoxMA=="</span><span class="p">,</span><span class="w">
        </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mark Zuckerberg"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Querying files acts the same as other types. All types that implement <code class="prettyprint">Blob</code> have a field <code class="prettyprint">blobUrl</code> and <code class="prettyprint">blobMimeType</code>
that are automatically managed by Scaphold. The <code class="prettyprint">blobUrl</code> is a pre-signed URL that points to your file in a private
blob store hosted on Amazon S3. If youre app is on a paid tier, all pre-signed URLs will be served by
a globally distributed CDN hosted by Amazon CloudFront.</p>

          <h1 id="app-management">App Management</h1>

<h2 id="aliases">Aliases</h2>

<p>Simplify your API URL with an alias!</p>

<p>Now when you create an app, you can choose to set an alias. An alias is a unique name for your application that can be used in the URL to access your API.
For example, if I set an alias for my app of <code class="prettyprint">scaphold</code> then I could access my application at the url <code class="prettyprint">https://us-west-2.api.scaphold.io/graphql/scaphold</code>.</p>

<aside class="notice">
  Alias names must be 6 characters or greater in length, must contain only lowercase letters, numbers, and dashes, and must not end or begin in a dash.
</aside>

<p>You can also change an alias at any time by clicking <code class="prettyprint">My API</code> at the top of the page.</p>

<p><img src="images/management/Set_Alias.png" alt="Copy and paste the code into your app." style="max-width: 75%" /></p>

<h2 id="analytics">Analytics</h2>

<p>Scaphold comes full circle with a comprehensive analytics dashboard so you can always get the latest updates on the performance, growth, and usage of your app in production.</p>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Request Counts</td>
<td>Total number of requests broken down by hour</td>
</tr>
<tr>
<td>Average Response Time</td>
<td>Measures latency (in seconds) in your API broken down by hour</td>
</tr>
<tr>
<td>User Growth</td>
<td>Tracks the number of new users that are signing up for your app</td>
</tr>
<tr>
<td>Data Throughput</td>
<td>Amount of data (in MB) that&rsquo;s being transmitted over the wire to your client apps</td>
</tr>
<tr>
<td>Resolvers by Type</td>
<td>Sorts your GraphQL requests by the associated type to help break down which part of your API is being used the most</td>
</tr>
<tr>
<td>Error Counts</td>
<td>Total number of errors broken down by hour</td>
</tr>
<tr>
<td>Application Logs</td>
<td>Table of all the latest logs for your API</td>
</tr>
</tbody></table>

<p>Our goal is to give you as much transparency as we can into your GraphQL API, so you can make the best app possible. Please email us at <a href="mailto:support@scaphold.io">support@scaphold.io</a>
if you have any requests for metrics you would like to see that would help you better measure and analyze the success of your app.</p>

<h2 id="export-schema">Export Schema</h2>

<p>Exporting your schema can be useful if you want to see what the raw JSON version of your data model looks like.</p>

<p>Scaphold manages two versions of your schema:</p>

<ol>
<li><p><strong>Standard GraphQL</strong>: Download a standard version of your GraphQL schema that you can use with any GraphQL server.</p></li>
<li><p><strong>Scaphold Schema</strong>: Save a copy of your up-to-date GraphQL schema that you can use to create an app on Scaphold.</p></li>
</ol>

<h2 id="fork-app">Fork App</h2>

<p>Forking an app will make an exact copy of the app in a new environment. That means the new app will automatically configure itself to be identical to the
source but it will have its own data, schema, and API. This is useful for testing schema changes before making any migrations to your production applications.
Once you have tested your changes and manually merged them into your production app you can safely remove the fork.</p>

<p>You can fork an app in 2 ways:</p>

<ol>
<li><p><strong>Apps Page &gt; Underneath each API link</strong> for each app panel (top-right)</p></li>
<li><p><strong>Settings Page &gt; Advanced</strong></p></li>
</ol>

<h2 id="teams">Teams</h2>

<p>App development is always more fun and faster in teams! Which is why we&rsquo;ve provided you the ability to collaborate with others on apps.</p>

<p>There are two ways to add a teammate:</p>

<ol>
<li><p><strong>Bottom left of the left side panel</strong> in the app-view.</p>

<p><img src="images/management/Add_Teammate_Panel.png" alt="Add a teammate in side panel" style="max-width:50%" /></p></li>
<li><p><strong>Settings Page &gt; Team</strong></p>

<p><img src="images/management/Add_Teammate_Settings.png" alt="Add a teammate in Settings" /></p></li>
</ol>

<p>In addition to adding a teammate, you may also want to remove a teammate. To do so, navigate to the <strong>Settings Page &gt; Team</strong>, click on the bubble under <strong>Teammates</strong>
that designates the user you wish to remove from this app, and a dropdown will appear that will allow you to remove that user.</p>

<aside class="notice">
  Transferring ownership of an app is also possible. Keep in mind that this will also transfer the payment method associated with a particular app, since payment methods
  belong to an individual user account (i.e. The app owner&rsquo;s payment source will always be the one associated with an app&rsquo;s billing).
</aside>

<h2 id="regions">Regions</h2>

<p>Scaphold is now deployed in multiple regions and counting! With growing demand for Scaphold&rsquo;s service by developers around the world, we&rsquo;re always open to setting up new infrastructure
so that your data lives closer to you.</p>

<p>Currently, we&rsquo;re deployed in&hellip;</p>

<ol>
<li><p>US West (Oregon)</p></li>
<li><p>EU West (Ireland)</p></li>
<li><p>More to come. If you wish to have Scaphold deployed on a data center in your region, please contact us at <a href="mailto:support@scaphold.io">support@scaphold.io</a>.</p></li>
</ol>

<p>To switch between regions, select the region you wish to use in the <strong>header bar of the Scaphold dashboard</strong>.</p>

<p><img src="images/management/Multi_Region.png" alt="Multiple regions" style="max-width:75%" /></p>

<aside class="notice">
  <b>Tip</b>: Your app&rsquo;s GraphQL API will be prefixed with the region that it belongs to (e.g. <code>https://us-west-2.api.scaphold.io/graphql/scaphold-graphql</code> is in the US West region).
</aside>

<h2 id="admin-tokens">Admin Tokens</h2>

<p>With admin tokens, you have the ability to bypass any permissions that have been set in your API. By setting this as <code class="prettyprint">Authorization: Bearer {ADMIN_TOKEN}</code> in your header
like any other auth token in Scaphold, you become an admin user. This is useful for importing or exporting data, any one-off data management tasks that need to be done, or scheduled jobs.</p>

<p>To create a admin token, navigate to <strong>Settings Page &gt; Admin Tokens &gt; Create</strong></p>

<aside class="notice">
  Note: Admin tokens never expire, unless you delete them.
</aside>

<h2 id="token-expiration">Token Expiration</h2>

<p>Scaphold gives you full control over how your tokens are managed for authentication. As such, we provide the ability to control the expiration of the JsonWebToken (JWT) measured in seconds
from when it was issued. This refers to the token issued during mutation calls such as <code class="prettyprint">loginUser</code>, or any social auth flow.</p>

<p>To configure the token expiration time, please navigate to <strong>Settings Page &gt; Advanced</strong></p>

<aside class="notice">
  The default value is 1,296,000 seconds (i.e. 15 days, or ~2 weeks).
</aside>

          <h1 id="starter-kits">Starter Kits</h1>

<p>The simplest way to get up and running is to use one of our GraphQL ready <a href="https://github.com/scaphold-io">starter kits on GitHub</a>.</p>

<h2 id="react-amp-apollo">React &amp; Apollo</h2>

<p><a href="https://github.com/scaphold-io/react-apollo-starter-kit">Download for React/Apollo</a></p>

<h3 id="quickstart">Quickstart</h3>

<p>1) Go to <a href="https://scaphold.io">Scaphold.io</a>.</p>

<p>2) Create an account and dataset.</p>

<p>3) Change the URL in the API manager (<code class="prettyprint">config.js</code>) in the boilerplate to point to your unique Scaphold.io API URL.</p>

<p>5) Install dependencies: <code class="prettyprint">npm install</code></p>

<p>4) Run with: <code class="prettyprint">npm start</code></p>

<h3 id="deployment">Deployment</h3>

<p>Note: For development, you only need to run npm start</p>

<p>1) Run npm run build to transpile ES6 code from the <code class="prettyprint">src/</code> directory to JavaScript in the <code class="prettyprint">lib/</code> directory.</p>

<p>2) Set the environment variable <code class="prettyprint">process.env.NODE_ENV = &#39;production&#39;</code> to let <code class="prettyprint">server.js</code> know to run the code in the <code class="prettyprint">lib/</code> directory.</p>

<h2 id="react-amp-relay">React &amp; Relay</h2>

<blockquote>
<p>Snippet from our React-Relay boilerplate (JavaScript only)</p>
</blockquote>
<pre class="highlight javascript"><code><span class="c1">// js/routes/HomeRoute.js</span>

<span class="nx">query</span> <span class="p">{</span>
  <span class="nx">viewer</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">{</span><span class="nx">Component</span><span class="p">.</span><span class="nx">getFragment</span><span class="p">(</span><span class="s1">'allHackerNewsItems'</span><span class="p">,</span> <span class="p">{</span><span class="na">orderBy</span><span class="p">:</span> <span class="nx">variables</span><span class="p">.</span><span class="nx">orderBy</span><span class="p">})}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="p">.</span> <span class="p">.</span> <span class="p">.</span>

<span class="c1">// js/components/HackerNewsClone/Home.js</span>

<span class="nx">fragment</span> <span class="nx">on</span> <span class="nx">Viewer</span> <span class="p">{</span>
  <span class="nx">allHackerNewsItems</span> <span class="p">(</span><span class="nx">first</span><span class="err">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">orderBy</span><span class="err">:</span> <span class="nx">$orderBy</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">edges</span> <span class="p">{</span>
      <span class="nx">cursor</span>
      <span class="nx">node</span> <span class="p">{</span>
        <span class="nx">id</span><span class="p">,</span>
        <span class="nx">createdAt</span><span class="p">,</span>
        <span class="nx">modifiedAt</span><span class="p">,</span>
        <span class="nx">title</span><span class="p">,</span>
        <span class="nx">score</span><span class="p">,</span>
        <span class="nx">url</span><span class="p">,</span>
        <span class="nx">author</span> <span class="p">{</span>
          <span class="nx">id</span><span class="p">,</span>
          <span class="nx">username</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a href="https://github.com/scaphold-io/react-relay-starter-kit">Download for React/Relay</a></p>

<p>Run this code by running <code class="prettyprint">npm start</code> in the base directory of the application. Once the application has built, go to <code>localhost:3001</code> in your browser to access your new website.</p>

<p>Congratulations! you&rsquo;ve successfully launched your first website with Scaphold. How is this all working? When the website runs, the starter kit points to a Scaphold endpoint that we&rsquo;ve created with some basic data. Your website leverages the GraphQL server that we&rsquo;ve already set up for you, so you can start creating users and logging in. After you&rsquo;ve successfully logged in, you&rsquo;ll be able to see a HackerNews clone with several articles listed. Getting this list of items is another request that is being made via a GraphQL query.</p>

<p>To demonstrate, upon logging in, here is the query that is being made to fetch the HackerNews data:</p>

<pre class="left">

</pre>

<p>These two pieces of code go together to form one query that grabs the first 10 HackerNewsItems from the app&rsquo;s dataset with the corresponding return fields like title, score, url, and author. To see what other queries you can make, feel free to navigate to the GraphiQL page from the header of the website and open up the document explorer on the top right. From here, you&rsquo;ll find a reference for query and mutation templates that are allowed for this particular app, and a sandbox to execute these particular requests.</p>

<p>If you would like to have a more involved or custom dataset to play around with, the beauty of Scaphold is that you can create your own in a matter of minutes! Jump right into the <a href="https://scaphold.io/docs#Tutorial">tutorial</a> to start building your first app.</p>

<p>This starter kit is yours to keep, and if you have any questions, don&rsquo;t hesitate to reach out to us through our chat support or email us at support@scaphold.io.</p>

<p>But wait, there&rsquo;s more! Here&rsquo;s the list of boilerplates that we provide that works right out of the box with Scaphold:</p>

<ul>
<li><a href="https://github.com/scaphold-io/react-relay-starter-kit">React &amp; Relay</a></li>
<li><a href="https://github.com/scaphold-io/react-native-starter-kit">React Native &amp; Relay</a></li>
<li>More to come&hellip; On the docket: iOS &amp; Android</li>
</ul>

<h2 id="angular2-amp-apollo-client">Angular2 &amp; Apollo Client</h2>

<p><a href="https://github.com/scaphold-io/angular2-apollo-client-webpack-starter">Download angular2-apollo-client-webpack-starter</a></p>

<p><a href="https://scaphold-io.github.io/">Live Demo</a></p>

<p>A GraphQL-ready starter kit for <a href="https://angular.io/">Angular2</a> using <a href="https://github.com/apollostack/apollo-client">Apollo Client</a> and Webpack. This starter kit is built to seamlessly
integrate with the <a href="https://scaphold.io">scaphold.io</a>&rsquo;s powerful GraphQL-as-a-Service platform.</p>

<p>Out of the box, the application handles authentication and exhibits pagination using GraphQL connections. The
template also comes packed with a few other goodies.</p>

<h3 id="table-of-contents">Table of contents</h3>

<ul>
<li><a href="#quick-start">Quick start</a></li>
<li><a href="#whats-included">What&rsquo;s included</a></li>
<li><a href="#project-structure">Project structure</a></li>
<li><a href="#documentation">Documentation</a>

<ul>
<li><a href="#apollo-client">Apollo Client</a></li>
<li><a href="#scaphold">Scaphold</a></li>
</ul></li>
<li><a href="#developing">Developing</a>

<ul>
<li><a href="#installing">Installing</a></li>
<li><a href="#running-the-app">Running the app</a></li>
<li><a href="#building">Building</a></li>
<li><a href="#generating-documentation">Generating Documentation</a></li>
<li><a href="#testing">Testing</a></li>
</ul></li>
</ul>
<pre class="highlight shell"><code><span class="c"># clone our repo</span>
<span class="c"># Take the master repo if you want to plug your own styling framework</span>
<span class="gp">$ </span>git clone https://github.com/scaphold-io/angular2-apollo-client-webpack-starter.git my-app

<span class="c"># The AngularMaterial branch comes preloaded with the popular angular2-material library</span>
<span class="gp">$ </span>git clone -b AngularMaterial https://github.com/scaphold-io/angular2-apollo-client-webpack-starter.git my-app

<span class="c"># update /my-app/src/config.ts with your scaphold api url</span>
<span class="gp">$ </span><span class="nb">cd </span>my-app
<span class="gp">$ </span>vi src/config.ts

<span class="c"># install the dependencies with npm</span>
<span class="gp">$ </span>npm install
<span class="c"># Your scaphold url will look something like https://api.scaphold.io/graphql/my-awesome-app-alias</span>

<span class="c"># start the server</span>
<span class="gp">$ </span>npm start
</code></pre>

<h3 id="quick-start">Quick start</h3>

<ul>
<li>Go to <a href="https://scaphold.io">scaphold.io</a> and create an account.</li>
<li>Create an application and get your GraphQL API&rsquo;s url from the dropdown in the nav bar.

<ul>
<li>A Scaphold app comes with a customizeable GraphQL API that you can immediately use to start building your Angular2 application.</li>
<li>Each API contains a default <code class="prettyprint">User</code> type that handles authentication necessities like password encryption out of the box. This template is built to seamlessly work with a fresh <a href="https://scaphold.io">scaphold.io</a> app.</li>
</ul></li>
<li>Setup this starter kit</li>
</ul>

<p>Your application is now hooked up to a production GraphQL API and is ready for you
to build an awesome app.</p>

<p>Go to <a href="http://localhost:8080">http://localhost:8080</a> to start using your API.</p>

<h3 id="what-39-s-included">What&rsquo;s included?</h3>

<ul>
<li>Apollo Client - A powerful, easy to use GraphQL client.</li>
<li>Webpack - A popular, well designed module bundler for JavaScript projects.</li>
<li>ES6, and ES7 support with babel.</li>
<li>Source maps for debugging.</li>
<li>Development server with live reload via webpack-dev-server.</li>
<li>Production builds with cache busting.</li>
<li>Unit testing via karma and jasmine.</li>
<li>Integration testing via protractor.</li>
<li>Code coverage when tests are run.</li>
</ul>

<h3 id="project-structure">Project Structure</h3>

<pre class="left">
angular2-apollo-webpack-starter/
├── src/                # Project Root
│   ├── app/            # Angular2 Application
│   │   ├── about/      # about, home, login, register all contain Angular components
│   │   ├── home/
│   │   ├── login/
│   │   ├── register/
│   │   ├── shared/              # shared contains Angular services. e.g. auth.service.ts
│   │   ├── app.component.html   # Each component has a X.component.html template file
│   │   ├── app.component.scss   # Component specific sass styling
│   │   ├── app.component.ts     # The component controller
│   │   ├── app.component.e2e-spec.js   # Protractor integration tests
│   │   ├── app.component.spec.ts       # Karma unit tests
│   │   ├── app.routes.ts        # Angular application router
│   │   └── client.ts/           # Apollo client initialization
│   ├── public/          # Public static assets
│   │   ├── img/
│   │   └── index.html
│   ├── style/           # Application wide sass styling
│   │   └── app.scss
│   ├── config.ts        # Contains your API's url.
│   ├── main.ts          # Application entry point
│   ├── polyfills.ts
│   └── vendor.ts        # Update application dependencies here
├── typings/             # Contains TypeScript definitions
│   ├── globals/
│   ├── modules/
│   └── index.d.ts
├── package.json
├── karma-shim.js
├── karma-conf.js
├── protractor.conf.js
├── tsconfig.json
├── tslint.json
├── typedoc.json
├── typings.json
├── webpack.config.js
├── LICENSE
└── README.md
```
</pre>

<h3 id="documentation">Documentation</h3>
<pre class="highlight plaintext"><code>@Apollo({
  client,
  queries(context) {
    return {
      data: {
        query: gql`
          query AllUsers($first: Int, $after: String, $last: Int, $before: String) {
            viewer {
              allUsers(first: $first, after: $after, last: $last, before: $before) {
                edges {
                  node {
                    id
                    username
                    lastLogin
                    createdAt
                    modifiedAt
                  }
                  cursor
                }
                pageInfo {
                  hasNextPage
                  hasPreviousPage
                }
              }
            }
          }
        `,
        variables: {
          first: context.first,
          after: context.after,
          last: context.last,
          before: context.before
        },
        forceFetch: false,
        returnPartialData: true,
        pollInterval: 10000
      }
    };
  }
})
</code></pre>

<h4 id="apollo-client">Apollo Client</h4>

<p>Apollo Client is an easy to use, framework agnostic GraphQL client library that makes it easy to integrate GraphQL with your app. In our experience it can be a little easier to work with than Relay and allows you to use non-React frameworks like Angular 2! Under the hood, Apollo Client uses the Redux state container for caching so that your queries run quickly and your data is always in sync.</p>

<h5 id="the-apollo-decorator">The Apollo Decorator</h5>

<p>Angular2 uses decorator functions to attach metadata to classes. Components use @Component, services use @Injectable, and classes that need GraphQL functionality use @Apollo. Take a look at the HomeComponent in <code class="prettyprint">src/home/home.component.ts</code>.</p>

<p>The Apollo decorator allows you to define queries and mutations and make them reactive so that your data stays up to date as properties in your component class change. @Apollo takes a single object with the keys <code class="prettyprint">client</code>, <code class="prettyprint">queries</code>, <code class="prettyprint">mutations</code> as a parameter and returns an object that maps to properties in the decorated class.</p>

<p>For the example above note how we have property <code class="prettyprint">data: any</code> in our HomeCompnoent class. We can access the data returned by the query defined in the @Apollo decorator via the <code class="prettyprint">data</code> property. Also note how the queries function in the parameter exposes a single <code class="prettyprint">context</code> argument. This <code class="prettyprint">context</code> points to the scope of the decorated class so that you can directly reference your component&rsquo;s state properties. This is extra awesome because Apollo Client automatically makes the queries defined in the @Apollo decorator reactive. This means that when properties in your class change so will your data. Apollo implements a bunch of cool tricks to make this efficient such that it only issues new API requests when needed and uses cached data in Redux for the rest.</p>

<p>You can find more documentation here for <a href="http://docs.apollostack.com/apollo-client/index.html">Apollo Client</a> and <a href="http://docs.apollostack.com/apollo-client/angular2.html">Angular2Apollo</a> (a native wrapper for Angular2)</p>

<h3 id="scaphold"><a href="https://scaphold.io">Scaphold</a></h3>

<p>Scaphold is a GraphQL-as-a-Service platform that makes it really easy to create production backends using GraphQL. Their web interface greatly simplifies the process of defining a GraphQL schema, integrations make adding other services like social authentication, stripe payments, email support, and push notifications a breeze, and the data exploration tools let you comb through your data without having to write GraphQL.</p>

<p>This template was created to work seamlessly with a fresh <a href="https://scaphold.io">scaphold.io</a> application and already has user registration and authentication configured for you. The HomeComponent <code class="prettyprint">src/home/home.component.ts</code> also includes and example of how you can easily implement pagination using Connections on Scaphold.</p>

<h4 id="pagination">Pagination</h4>

<blockquote>
<p>Note: We advise you only use (<code class="prettyprint">first</code> and <code class="prettyprint">after</code>) OR (<code class="prettyprint">last</code> and <code class="prettyprint">before</code>) at any given time. Although you technically can use both at the same time it can lead to unexpected results. See the <a href="https://facebook.github.io/relay/graphql/connections.htm">Cursor Connections Spec</a> for more details.</p>
</blockquote>
<pre class="highlight plaintext"><code>query AllUsers($first: Int, $after: String, $last: Int, $before: String) {
    viewer {
        allUsers(first: $first, after: $after, last: $last, before: $before) {
            edges {
                node {
                    id
                    username
                    lastLogin
                    createdAt
                    modifiedAt
                }
                cursor
            }
            pageInfo {
                hasNextPage
                hasPreviousPage
            }
        }
    }
}
</code></pre>

<blockquote>
<p>It also binds the connection arguments to 4 properties in the HomeComponent class.</p>
</blockquote>
<pre class="highlight plaintext"><code>variables: {
  first: context.first,
  after: context.after,
  last: context.last,
  before: context.before
}
</code></pre>

<p>A necessary part of any application is the ability to paginate through data in arbitrarily sized <em>pages</em>. To do this in GraphQL, we use <em>Connections</em>. A <em>Connection</em> is a standards based approach to pagination that offers a efficient and straigh-forward pagination mechanism.</p>

<p>A GraphQL connection field takes 4 arguments</p>

<ul>
<li><code class="prettyprint">first</code>: An integer specifying the count of objects following the <code class="prettyprint">after</code> cursor in a sequence that should be included in the response.</li>
<li><code class="prettyprint">after</code>: A string &lsquo;cursor&rsquo;. This is an opaque identifier that points to an object in a sequence. It specifies where our page slice should start in a sequence and is used with <code class="prettyprint">first</code>. Results are bounds-exclusive and will start strictly after this cursor.</li>
<li><code class="prettyprint">last</code>: An integer specifying the count of objects precursing the <code class="prettyprint">before</code> cursor in a sequence that should be included in the response.</li>
<li><code class="prettyprint">before</code>: A string &#39;cursor&rsquo;. This is an opaque identifier that points to an object in a sequence. It specifies where our page slice should end in a sequence and is used with <code class="prettyprint">last</code>. Results are bounds-exclusive and will start strictly before this cursor.</li>
</ul>

<p>The HomeComponent defines the following GraphQL query in the @Apollo decorator function.</p>

<p>With this setup, we are able to immediately start paginating through our User data by changing the <code class="prettyprint">first</code>, <code class="prettyprint">after</code>, <code class="prettyprint">last</code>, and <code class="prettyprint">before</code> properties in the HomeComponent class. Apollo Client automatically handles making our query reactive and will make sure the presented data stays in sync with our class properties.</p>
<pre class="highlight javascript"><code><span class="kr">const</span> <span class="nx">edgeCount</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">viewer</span><span class="p">.</span><span class="nx">allUsers</span><span class="p">.</span><span class="nx">edges</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">afterCursor</span> <span class="o">=</span> <span class="p">(</span><span class="nx">edgeCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">viewer</span><span class="p">.</span><span class="nx">allUsers</span><span class="p">.</span><span class="nx">edges</span><span class="p">[</span><span class="nx">edgeCount</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="s1">'cursor'</span><span class="p">]</span> <span class="p">:</span> <span class="kc">null</span><span class="p">;</span>
<span class="k">this</span><span class="p">.</span><span class="nx">after</span> <span class="o">=</span> <span class="nx">afterCursor</span><span class="p">;</span>
<span class="k">this</span><span class="p">.</span><span class="nx">first</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">defaultPageSize</span><span class="p">;</span>
<span class="k">this</span><span class="p">.</span><span class="nx">before</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="k">this</span><span class="p">.</span><span class="nx">last</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</code></pre>

<p>Try out different values to experiment with Cursor Connection pagination.</p>

<h3 id="installing">Installing</h3>

<pre class="left">
# For or clone this repo
# Take the master repo if you want to plug your own styling framework
$ git clone https://github.com/scaphold-io/angular2-apollo-client-webpack-starter.git my-app

# The AngularMaterial branch comes preloaded with the popular angular2-material library
$ git clone -b AngularMaterial https://github.com/scaphold-io/angular2-apollo-client-webpack-starter.git my-app

# update /my-app/src/config.ts with your scaphold api url
$ cd my-app
$ vi src/config.ts

# install the dependencies with npm
$ npm install
# Your scaphold url will look something like https://api.scaphold.io/graphql/my-awesome-app-alias

# start the server
$ npm start
</pre>

<p>What you need to run this app:
* <code class="prettyprint">node</code> and <code class="prettyprint">npm</code>
* We tested this template with Node (<code class="prettyprint">v4.x</code>+) and NPM (<code class="prettyprint">3.x</code>+) but others will most likely work as well</p>

<h3 id="running-the-app">Running the app</h3>

<p>After you have installed all dependencies you can now run the app with: <code class="prettyprint">npm start</code></p>

<p>It will start a local server using <code class="prettyprint">webpack-dev-server</code> which will watch, build (in-memory), and reload for you. The port will be displayed to you as <code class="prettyprint">http://localhost:8080</code>.</p>

<h3 id="developing">Developing</h3>

<h4 id="building">Building</h4>

<ul>
<li>single run: <code class="prettyprint">npm run build</code></li>
<li>build files and watch for changes: <code class="prettyprint">npm run watch</code></li>
</ul>

<h4 id="generating-documentation">Generating Documentation</h4>

<ul>
<li><code class="prettyprint">npm run docs</code></li>
<li>This uses <a href="http://typedoc.io/">TypeDoc</a> and understand JavaDoc style tags</li>
</ul>

<h3 id="testing">Testing</h3>

<h4 id="1-unit-tests">1. Unit Tests</h4>

<ul>
<li>single run: <code class="prettyprint">npm test</code></li>
<li>live mode: <code class="prettyprint">npm run test-watch</code></li>
</ul>

<h4 id="2-integration-tests">2. Integration Tests</h4>

<ul>
<li>single run: <code class="prettyprint">npm e2e</code></li>
<li>live mode: <code class="prettyprint">npm e2e-live</code></li>
</ul>

<h3 id="contributing">Contributing</h3>

<p>Please feel free to fork this project and contribute. Send us a pull request and we&rsquo;d be happy to merge :)</p>

          <h1 id="changelog">Changelog</h1>

<h2 id="december-7-2016">December 7, 2016</h2>

<ul>
<li><p><a href="#regions">Multiple Regions</a>: We&rsquo;re launched to two regions now - US West (Oregon) and EU West (Ireland).
Please message us if you have a need for a new data center in your region!</p></li>
<li><p><a href="#super-tokens">Super Tokens</a>: Create a new super token with a click of a button. Use this for administrative tasks.</p></li>
<li><p><a href="#token-expiration">Token Expiration</a>: Configure the expiration time of your JWT tokens for your users.</p></li>
</ul>

          <h1 id="errors">Errors</h1>

<blockquote>
<p>A typical Scaphold response</p>
</blockquote>
<pre class="highlight plaintext"><code>type ScapholdResult {
    data: any
    errors: [ScapholdError]
}

type ScapholdError {
    message: string!
    code: ErrorCode
    param: string
}
</code></pre>

<aside class="notice">
Errors from the Scaphold API will be returned as a list under the `errors` attribute at the root of the response.
I.E. Scaphold responses adhere to the ScapholdResult type.
</aside>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK &ndash; Everything is working as expected</td>
</tr>
<tr>
<td>400</td>
<td>Bad Request &ndash; There was an error in your request.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API token is wrong or missing</td>
</tr>
<tr>
<td>402</td>
<td>Payment Required &ndash; You have exceeded the free pricing teir. Please input a payment option via the Account page.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; You have a valid API token but you do not have permission to this page.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified resource could not be found.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You have approached the 60 req/s limit. Please try to spread out your requests more evenly.</td>
</tr>
<tr>
<td>440</td>
<td>Login Failure &ndash; We either couldn&rsquo;t find a user with that email or your password was incorrect.</td>
</tr>
<tr>
<td>441</td>
<td>Registration Failure &ndash; Invalid registration information. E.G. a user with that username already exists.</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Please contact us via slack or try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Happens very rarely.</td>
</tr>
</tbody></table>

          <h1 id="faq">FAQ</h1>

<p>Can&rsquo;t find what you&rsquo;re looking for? Contact us on <a href="https://scapholdslackin.herokuapp.com/">Slack</a>!</p>

<h3 id="what-can-i-build">What can I build?</h3>

<p>Whether you&rsquo;re building a mobile or web app, we&rsquo;ve got you covered. Scaphold will help you through every level of the development process. Use our schema designer to structure your data, GraphiQL to prototype your queries and export them directly into your client applications, monitor your application in our dashboard, and integrate popular services to extend your API.</p>

<h3 id="can-i-trust-scaphold-when-a-service-like-parse-shutdown">Can I trust Scaphold when a service like Parse shutdown?</h3>

<p>YES! We are Ycombinator backed company and are going strong! To help ease your mind, it is important to note that Facebook shut down Parse because it no longer fit in with their core strategy. There is a still a need for powerful BaaS products and we are here to bring you one.</p>

<p>In the extremely unlikely event that we do shut down then you still don&rsquo;t need to worry! GraphQL is a 100% open spec and you have the freedom to build a GraphQL API just like the ones we expose to you! You might lose some of the bells and whistles such as our seamless integrations but your business will survive and your client application code will remain the same!</p>

<h3 id="how-do-we-compare-with-other-baas-products">How do we compare with other BaaS products?</h3>

<p>We think GraphQL is the best way to build apps. It&rsquo;s that simple. There are other existing services like Firebase and Kinvey but they suffer from the same problems that have been plaguing BaaS solutions for years. This means vendor lock-in, complicated REST APIs, limited SDKs, and lack of flexibility. Scaphold turns this around and presents you with a standardized, extensible, and flexible GraphQL backend that can fit all kinds of application needs. Our GraphQL API releases you from vendor lock-in, provides you with API that anyone can understand, exposes a richer query language, and allows you to extend your APIs functionality with our many integrations. On top of all of this, our pricing model is the best in the industry so you can squeeze as much out of every dollar as possible!</p>

<h3 id="what-is-our-sla">What is our SLA?</h3>

<p>Although we do not currently expose a standard SLA, our services run on a distributed cluster that was designed to prevent a single point of failure from bringing down our services. In the unlikely event that our services do go down for a time, we have systems working around the clock that will let us know so we can quickly fix the problem. You can trust that we are doing everything we can to provide the best possible experience for our clients and will continually push for 6 nines.</p>

<h3 id="who-is-using-graphql">Who is using GraphQL?</h3>

<p>The biggest proponent of GraphQL by far is Facebook. They designed GraphQL to solve many of the problems that they experienced when building many of their web and mobile products and they are using the technology to power more and more of their products. It&rsquo;s not just Facebook however! Companies like Twitter, Meteor, and Kadira are also using GraphQL heavily and the feedback has been overwhelmingly positive.</p>

<h3 id="how-do-i-get-support">How do I get support?</h3>

<p>It&rsquo;s our goal to make your life as a developer as easy as possible and that means haveing great customer support. The best way to get support is either using the Intercom chat bubble on this page or to join us on Slack at <a href="https://scapholdslackin.herokuapp.com/">Scaphold Slack</a>. Please feel free to contact us at any hour of the day and we will respond as soon as possible!</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
                <a href="#" data-language-name="javascript">JavaScript</a>
          </div>
      </div>
    </div>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-87284467-1', 'auto');
      ga('send', 'pageview');
    </script>

    <script>
      window.intercomSettings = {
        app_id: "j46v879e"
      };
    </script>
    <script>
      (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',intercomSettings);}else{var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/j46v879e';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})()
    </script>

  </body>
</html>
